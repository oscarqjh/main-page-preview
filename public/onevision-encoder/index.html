<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>OneVision Encoder | LMMs-Lab</title>
    <link rel="icon" href="/icon.png" type="image/png">
    <!-- Tailwind CSS -->
    <script src="https://cdn.tailwindcss.com"></script>
    <!-- Font Awesome -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <!-- Google Fonts -->
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&display=swap" rel="stylesheet">

    <style>
        body {
            font-family: 'Inter', sans-serif;
            color: #fed7aa;
            line-height: 1.7;
            background-color: #0369a1;
        }

        /* --- Universal Utils --- */
        .gradient-text {
            color: #fed7aa;
            font-weight: 700;
        }
        .hero-bg {
            background: #0369a1;
            border-bottom: 1px solid rgba(254, 215, 170, 0.1);
        }

        /* --- Component Styles --- */
        .nav-link {
            transition: color 0.2s ease;
            color: #fed7aa;
            opacity: 0.8;
            font-weight: 500;
            font-size: 0.9rem;
        }
        .nav-link:hover { color: #ffffff; opacity: 1; }

        /* Buttons - Minimalistic with flat design */
        .btn {
            display: inline-flex;
            align-items: center;
            gap: 0.5rem;
            padding: 0.625rem 1.5rem;
            border-radius: 0.375rem;
            font-weight: 500;
            font-size: 0.9rem;
            transition: all 0.2s ease;
            border: 1px solid transparent;
        }
        .btn-primary {
            background-color: #fed7aa;
            color: #0369a1;
        }
        .btn-primary:hover {
            background-color: #ffffff;
            transform: translateY(-1px);
        }

        .btn-accent {
            background-color: transparent;
            color: #fed7aa;
            border-color: #fed7aa;
        }
        .btn-accent:hover {
            background-color: rgba(254, 215, 170, 0.1);
            border-color: #ffffff;
            color: #ffffff;
        }

        .btn-secondary {
            background-color: transparent;
            color: #fed7aa;
            border-color: rgba(254, 215, 170, 0.3);
        }
        .btn-secondary:hover {
            background-color: rgba(254, 215, 170, 0.1);
            color: #ffffff;
            border-color: #fed7aa;
        }

        /* Feature Cards - Cleaner with minimal shadows */
        .feature-card {
            background-color: transparent;
            padding: 2.5rem 2rem;
            border-radius: 0.5rem;
            box-shadow: 0 1px 3px 0 rgba(0, 0, 0, 0.05);
            border: 1px solid rgba(254, 215, 170, 0.2);
            transition: all 0.2s ease;
        }
        .feature-card:hover {
            transform: translateY(-2px);
            box-shadow: 0 4px 12px 0 rgba(0, 0, 0, 0.08);
            border-color: #fed7aa;
            background-color: rgba(254, 215, 170, 0.05);
        }
        .icon-box {
            height: 3rem;
            width: 3rem;
            border-radius: 0.5rem;
            display: flex;
            align-items: center;
            justify-content: center;
            margin-bottom: 1.25rem;
            font-size: 1.5rem;
        }

        /* --- Table Styles - Brutalist dark theme --- */
        .data-table {
            width: 100%;
            border-collapse: collapse;
            table-layout: fixed;
            box-shadow: 0 0 0 2px #fed7aa;
        }
        .data-table th {
            padding: 8px 10px;
            text-align: left;
            font-size: 0.75rem;
            font-weight: 700;
            color: #fed7aa;
            background-color: rgba(254, 215, 170, 0.1);
            border: 1px solid #fed7aa;
        }
        /* Sticky First Column */
        .data-table .sticky-col {
            position: sticky;
            left: 0;
            z-index: 10;
            padding: 8px 10px;
            white-space: nowrap;
            font-weight: 600;
            background-color: #0369a1;
            color: #fed7aa;
            text-align: left;
            border: 1px solid #fed7aa;
        }
        .data-table td {
            padding: 6px 10px;
            text-align: left;
            font-size: 0.75rem;
            color: #fed7aa;
            border: 1px solid #fed7aa;
            background-color: transparent;
        }

        /* Table Hover */
        .data-table tbody tr:not(.section-header):hover td {
            background-color: rgba(254, 215, 170, 0.05);
        }

        /* Section Header */
        .section-header td {
            text-align: left;
            padding: 0.5rem 1rem;
            background-color: rgba(254, 215, 170, 0.15);
            font-weight: 700;
            color: #fed7aa;
            font-size: 0.75rem;
            letter-spacing: 0.02em;
            border: 1px solid #fed7aa;
        }

        /* Highlight Row (Ours) - Cream highlight for OneVision Encoder */
        .row-highlight td {
            background-color: rgba(254, 215, 170, 0.06) !important;
            color: #fed7aa !important;
            font-weight: 700;
        }
        .row-highlight .sticky-col {
            background-color: rgba(3, 105, 161, 0.92) !important;
            color: #fed7aa !important;
            box-shadow: 2px 0 10px rgba(0,0,0,0.12);
        }
        .highlight-val {
            display: inline;
            padding: 0;
            border-radius: 0;
            background: transparent;
            box-shadow: none;
            color: rgba(254, 215, 170, 0.98) !important;
            font-weight: 800 !important;
        }
        /* Cream highlight for OV-Encoder columns */
        .highlight-orange {
            background-color: rgba(254, 215, 170, 0.2) !important;
        }
        .highlight-orange-header {
            background-color: rgba(254, 215, 170, 0.3) !important;
            color: #fed7aa !important;
        }
        .bg-header-gray {
            background-color: rgba(254, 215, 170, 0.1) !important;
            color: #fed7aa !important;
            font-weight: 600;
        }

        /* Table Wrapper for MLLM Table */
        .table-wrapper {
            display: block;
            width: 100%;
            overflow-x: auto;
            -webkit-overflow-scrolling: touch;
            border-radius: 0.75rem;
            border: 1px solid rgba(254, 215, 170, 0.22);
            background: rgba(254, 215, 170, 0.03);
        }


        /* Centered figures and tables */
        .figure-centered {
            display: flex;
            justify-content: center;
        }
        .table-centered {
            margin-left: auto;
            margin-right: auto;
        }

        /* MLLM Table Styles */
        .results-table {
            width: 100%;
            border-collapse: separate;
            border-spacing: 0;
            font-size: 0.8125rem; /* 13px */
            font-variant-numeric: tabular-nums;
        }

        /* Neutralize Tailwind's divide-y on some table bodies for consistent grid */
        .results-table tbody {
            background: transparent !important;
        }

        .results-table tbody.divide-y > :not([hidden]) ~ :not([hidden]) {
            border-top-width: 0 !important;
        }
        .results-table th, .results-table td {
            padding: 9px 12px;
            text-align: center;
            color: rgba(254, 215, 170, 0.92);
            border-bottom: 1px solid rgba(254, 215, 170, 0.14);
        }
        .results-table th {
            padding: 10px 12px;
            background-color: rgba(254, 215, 170, 0.08);
            font-weight: 700;
            color: rgba(254, 215, 170, 0.96);
            border-bottom: 1px solid rgba(254, 215, 170, 0.22);
        }

        /* Subtle vertical grid */
        .results-table th + th,
        .results-table td + td {
            border-left: 1px solid rgba(254, 215, 170, 0.10);
        }

        /*
          Rowspan-safe header separators:
          In the first results table, the first two header cells use rowspan=2.
          That makes the first cell in the `.sub-header` row not adjacent to a
          sibling in the same row, so `th + th` won't draw the left separator.
        */
        .results-table thead tr.sub-header th:first-child {
            border-left: 1px solid rgba(254, 215, 170, 0.10);
        }

        /* Group header rows */
        .results-table tr.header-group th {
            background-color: rgba(3, 105, 161, 0.78);
            border-bottom: 1px solid rgba(254, 215, 170, 0.22);
        }
        .results-table tr.sub-header th {
            background-color: rgba(3, 105, 161, 0.68);
            font-size: 0.75rem;
            color: rgba(254, 215, 170, 0.95);
        }

        /* Second table uses Tailwind helper classes - normalize to the same header language */
        .results-table thead th[style*='background-color'] {
            background-color: rgba(254, 215, 170, 0.08) !important;
        }

        /* Sticky first column (used by the second table) */
        .results-table .sticky-col {
            position: sticky;
            left: 0;
            z-index: 5;
            background: rgba(3, 105, 161, 0.92);
            backdrop-filter: blur(6px);
            border-right: 1px solid rgba(254, 215, 170, 0.16);
        }

        .results-table thead .sticky-col {
            z-index: 10;
            background: rgba(254, 215, 170, 0.08) !important;
        }
        .results-table .row-header {
            text-align: left;
            font-weight: 600;
            background-color: rgba(3, 105, 161, 0.55);
            color: rgba(254, 215, 170, 0.95);
            padding-left: 12px;
        }
        .results-table .row-avg {
            background-color: rgba(254, 215, 170, 0.05);
            font-weight: 600;
        }
        /* Highlight OV-Encoder columns - keep it minimal (header carries most of the emphasis) */
        .results-table .highlight-ours {
            background-color: rgba(254, 215, 170, 0.04);
            color: rgba(254, 215, 170, 0.96) !important;
        }
        /* Override for header cells */
        .results-table th.highlight-ours {
             color: rgba(254, 215, 170, 0.98) !important;
             background-color: rgba(254, 215, 170, 0.14);
             font-weight: 800;
        }
        /* Override for data cells */
        .results-table td.highlight-ours {
             color: rgba(254, 215, 170, 0.98) !important;
             background-color: transparent;
        }

        .results-table .val-up {
            color: #4ade80;
            font-size: 0.8em;
            margin-left: 4px;
        }
        .results-table .val-down {
            color: #fb923c;
            font-size: 0.8em;
            margin-left: 4px;
        }
        .results-table .best-val {
            /* Use the page foreground instead of pure white */
            color: rgba(254, 215, 170, 0.98);
            font-weight: 800;
            text-shadow: 0 1px 0 rgba(0, 0, 0, 0.18);
        }

        /* Option A: corner mark for emphasized cells (best / highlighted) */
        .results-table td.best-val,
        .results-table td.marked-val {
            position: relative;
        }

        .results-table td.best-val::before,
        .results-table td.marked-val::before {
            content: '';
            position: absolute;
            top: 7px;
            right: 9px;
            width: 12px;
            height: 12px;
            border-top: 2px solid rgba(254, 215, 170, 0.65);
            border-right: 2px solid rgba(254, 215, 170, 0.65);
            border-top-right-radius: 2px;
            opacity: 0.65;
            transition: opacity 160ms ease, border-color 160ms ease;
        }

        /* Bottom-left corner to mimic camera focus frame */
        .results-table td.best-val::after,
        .results-table td.marked-val::after {
            content: '';
            position: absolute;
            left: 9px;
            bottom: 7px;
            width: 12px;
            height: 12px;
            border-left: 2px solid rgba(254, 215, 170, 0.65);
            border-bottom: 2px solid rgba(254, 215, 170, 0.65);
            border-bottom-left-radius: 2px;
            opacity: 0.65;
            transition: opacity 160ms ease, border-color 160ms ease;
        }

        /* Hover scan shimmer - camera focus style (no fade-out while emphasizing) */
        @keyframes focusFrameScan {
            0% {
                background-position: 0 0, 120% 0;
            }
            100% {
                background-position: 0 0, -120% 0;
            }
        }

        .results-table td.best-val:hover::before,
        .results-table td.marked-val:hover::before,
        .results-table td.best-val:focus-visible::before,
        .results-table td.marked-val:focus-visible::before {
            opacity: 0.95;
            border-top-color: rgba(254, 215, 170, 0.92);
            border-right-color: rgba(254, 215, 170, 0.92);
        }

        .results-table td.best-val:hover::after,
        .results-table td.marked-val:hover::after,
        .results-table td.best-val:focus-visible::after,
        .results-table td.marked-val:focus-visible::after {
            opacity: 0.95;
            border-left-color: rgba(254, 215, 170, 0.92);
            border-bottom-color: rgba(254, 215, 170, 0.92);
        }

        .results-table td.best-val:hover,
        .results-table td.marked-val:hover,
        .results-table td.best-val:focus-visible,
        .results-table td.marked-val:focus-visible {
            /* Base highlight stays; scan is an additional moving layer */
            background-image:
                linear-gradient(0deg, rgba(254, 215, 170, 0.06), rgba(254, 215, 170, 0.06)),
                linear-gradient(
                    90deg,
                    transparent 0%,
                    rgba(254, 215, 170, 0.00) 26%,
                    rgba(254, 215, 170, 0.16) 48%,
                    rgba(254, 215, 170, 0.00) 70%,
                    transparent 100%
                );
            background-size: 100% 100%, 220% 100%;
            background-repeat: no-repeat;
            background-position: 0 0, 120% 0;
            animation: focusFrameScan 680ms ease-out 1;
        }

        /* Subtle focus halo on hover - keeps table consistent */
        .results-table td.best-val:hover,
        .results-table td.marked-val:hover,
        .results-table td.best-val:focus-visible,
        .results-table td.marked-val:focus-visible {
            box-shadow: inset 0 0 0 1px rgba(254, 215, 170, 0.16), 0 0 0 3px rgba(254, 215, 170, 0.04);
        }

        @media (prefers-reduced-motion: reduce) {
            .results-table td.best-val:hover,
            .results-table td.marked-val:hover,
            .results-table td.best-val:focus-visible,
            .results-table td.marked-val:focus-visible {
                animation: none;
                /* Keep emphasis without motion */
                background-image: linear-gradient(0deg, rgba(254, 215, 170, 0.06), rgba(254, 215, 170, 0.06));
                background-size: 100% 100%;
                background-position: 0 0;
            }
        }

        /* Touch devices: keep the mark visible (no hover) */
        @media (hover: none) {
            .results-table td.best-val::before,
            .results-table td.marked-val::before {
                opacity: 0.85;
            }

            .results-table td.best-val::after,
            .results-table td.marked-val::after {
                opacity: 0.85;
            }
        }
        /* Ensure best-val in highlight-ours is still visible */
        .results-table .highlight-ours.best-val {
            color: rgba(254, 215, 170, 0.98) !important;
            font-weight: 800;
            text-shadow: 0 1px 0 rgba(0, 0, 0, 0.18);
        }

        .task-group-cell {
            vertical-align: middle;
            font-weight: 800;
            background-color: rgba(3, 105, 161, 0.72);
            color: rgba(254, 215, 170, 0.95);
            border-right: 1px solid rgba(254, 215, 170, 0.18);
            padding: 12px 12px;
        }

        /* Separator line for LMM table - gold/orange vertical divider */
        .results-table th.separator-left,
        .results-table td.separator-left {
            border-left: 2px solid #fed7aa !important;
        }

        /* Mobile-specific visual enhancements */
        @media (max-width: 768px) {
            /* Add visual separator between sections */
            section {
                border-bottom: 1px solid rgba(254, 215, 170, 0.2);
            }

            section:last-of-type {
                border-bottom: none;
            }

            /* Improve table container styling */
            .overflow-x-auto {
                background: #0369a1;
                border: 1px solid rgba(254, 215, 170, 0.2);
            }

            /* Better video container on mobile */
            video, img {
                max-width: 100%;
                height: auto;
            }

            /* Improve figure captions on mobile */
            figcaption {
                padding: 0 0.5rem;
                font-size: 0.75rem !important;
            }
        }

        /* --- Mobile Responsive Styles --- */
        @media (max-width: 768px) {
            /* Smooth scrolling for mobile */
            html {
                scroll-behavior: smooth;
            }

            /* Navigation - Mobile hamburger menu */
            .mobile-menu-button {
                display: block;
                background: none;
                border: none;
                cursor: pointer;
                padding: 0.5rem;
            }

            .mobile-menu-button i {
                font-size: 1.5rem;
                color: #fed7aa;
            }

            .mobile-nav {
                display: none;
                position: fixed;
                top: 64px;
                left: 0;
                right: 0;
                background: #0369a1;
                border-bottom: 1px solid rgba(254, 215, 170, 0.2);
                padding: 1rem;
                z-index: 40;
                box-shadow: 0 4px 6px -1px rgba(0, 0, 0, 0.1);
            }

            .mobile-nav.active {
                display: block;
            }

            .mobile-nav a {
                display: block;
                padding: 0.75rem 0;
                border-bottom: 1px solid rgba(254, 215, 170, 0.1);
                font-size: 1rem;
            }

            .mobile-nav a:last-child {
                border-bottom: none;
            }

            /* Hero Section - Reduce text sizes */
            .hero-bg {
                padding-top: 5rem !important;
                padding-bottom: 2.5rem !important;
            }

            h1 {
                font-size: 2.25rem !important;
                line-height: 1.15 !important;
                margin-bottom: 1.25rem !important;
            }

            h1 + p {
                font-size: 1.05rem !important;
                line-height: 1.5 !important;
                margin-bottom: 1rem !important;
            }

            /* Buttons - Better mobile layout */
            .btn {
                padding: 0.7rem 1.25rem;
                font-size: 0.85rem;
            }

            /* Navigation buttons - Keep inline on desktop */
            nav .flex.items-center.gap-2 {
                flex-wrap: wrap;
                gap: 0.5rem;
            }

            nav .btn {
                width: auto;
                padding: 0.5rem 0.75rem;
                font-size: 0.75rem;
            }

            /* Section headings */
            h3 {
                font-size: 1.5rem !important;
                margin-bottom: 1rem !important;
            }

            h4 {
                font-size: 1.125rem !important;
            }

            /* Tables - Enhanced mobile experience */
            .table-wrapper,
            .overflow-x-auto {
                overflow-x: auto;
                -webkit-overflow-scrolling: touch;
                position: relative;
                border-radius: 0.5rem;
                box-shadow: 0 1px 3px 0 rgba(0, 0, 0, 0.1);
            }

            /* Add scroll hint for tables */
             .table-wrapper::after,
             .overflow-x-auto::after {
                content: '← Scroll →';
                position: sticky;
                right: 0;
                bottom: 0;
                background: linear-gradient(90deg, transparent 0%, rgba(3, 105, 161, 0.96) 28%);
                padding: 0.5rem 1rem;
                font-size: 0.7rem;
                color: rgba(254, 215, 170, 0.7);
                text-align: right;
                pointer-events: none;
                font-weight: 500;
             }

            .data-table,
            .results-table {
                min-width: 800px;
            }

            /* Improve sticky column on mobile */
            .data-table .sticky-col {
                box-shadow: 2px 0 8px rgba(0, 0, 0, 0.1);
            }

            /* Feature cards - Full width on mobile */
            .feature-card {
                padding: 1.5rem 1rem;
            }

            /* Image grid containers - Better mobile display */
            .bg-[#0369a1].rounded-xl {
                padding: 1rem !important;
                margin-bottom: 1.5rem !important;
                overflow: visible !important;
            }

            /* Better spacing for section titles on mobile */
            h4 {
                font-size: 1rem !important;
                margin-bottom: 0.75rem !important;
            }

            /* Pipeline section - Enhanced mobile layout */
            #pipelinePrevBtn,
            #pipelineNextBtn {
                width: 30px;
                height: 30px;
            }

            #pipelinePrevBtn i,
            #pipelineNextBtn i {
                font-size: 0.75rem !important;
            }

            #pipelineDots button {
                width: var(--pipeline-seg-hit) !important;
                height: var(--pipeline-seg-hit) !important;
            }

            /* Pipeline labels - Better responsive layout */
            .pipeline-labels {
                display: flex !important;
                flex-direction: row !important;
                justify-content: space-around !important;
                align-items: center !important;
                margin-bottom: 0.75rem !important;
                padding: 0 0.5rem !important;
                flex-wrap: nowrap !important;
                gap: 0.25rem !important;
            }
            
            .pipeline-label {
                flex: 1;
                text-align: center;
                font-size: 0.625rem;
                line-height: 1.2;
                font-weight: 600;
                color: #fed7aa;
                white-space: normal;
                padding: 0 0.125rem;
                word-break: break-word;
            }

            /* Video container - Mobile optimized sizing */
            #pipelineGifContainer {
                margin-bottom: 0.5rem;
            }

            /* Pipeline video container wrapper - reduce padding on mobile */
            .mt-16 > div[style*="max-width: 1100px"] > div[style*="border-radius: 0.75rem"] {
                padding: 0.5rem !important;
            }

            /* Pipeline description text - smaller on mobile */
            #pipelineDescription {
                font-size: 0.7rem !important;
                margin-top: 0.75rem !important;
                line-height: 1.3 !important;
            }

            /* Pipeline navigation gap - reduce spacing on mobile */
            div[style*="display: flex"][style*="gap: 1rem"] {
                gap: 0.5rem !important;
            }

            /* Pagination controls - Better spacing */
            div[style*="display: flex"][style*="justify-content: center"] {
                margin-top: 1rem !important;
            }

            /* Padding adjustments */
            section {
                padding-top: 2rem !important;
                padding-bottom: 2rem !important;
            }

            /* Container padding */
            .max-w-5xl,
            .max-w-6xl,
            .max-w-7xl {
                padding-left: 1rem !important;
                padding-right: 1rem !important;
            }

            /* Font size adjustments */
            body {
                font-size: 0.9rem;
            }

            .text-base,
            p {
                font-size: 0.875rem !important;
                line-height: 1.6 !important;
                margin-bottom: 1rem !important;
            }

            .text-xs {
                font-size: 0.65rem !important;
            }

            /* Images - Better mobile sizing */
            figure img,
            figure video {
                border-radius: 0.5rem !important;
            }

            /* BibTeX section - Better mobile display */
            #bibtex pre {
                font-size: 0.7rem !important;
                line-height: 1.4 !important;
                padding: 1rem !important;
                overflow-x: auto !important;
            }

            /* Better touch targets */
            a, button {
                min-height: 44px;
                min-width: 44px;
            }

            /* Icon adjustments */
            .icon-box {
                height: 2.5rem;
                width: 2.5rem;
                font-size: 1.25rem;
            }
        }

        /* Extra small devices (phones in portrait, less than 480px) */
        @media (max-width: 480px) {
            h1 {
                font-size: 1.875rem !important;
            }

            h1 + p {
                font-size: 0.95rem !important;
            }

            .hero-bg {
                padding-top: 4.5rem !important;
                padding-bottom: 2rem !important;
            }

            h3 {
                font-size: 1.25rem !important;
            }

            .pipeline-label {
                font-size: 0.5rem !important;
            }

            #image-grid-codec,
            #image-grid-sampling {
                transform: scale(0.45);
                margin-bottom: -80px;
            }

            #pipelinePrevBtn,
            #pipelineNextBtn {
                width: 28px;
                height: 28px;
            }

            #pipelinePrevBtn i,
            #pipelineNextBtn i {
                font-size: 0.7rem !important;
            }

            #pipelineDots button {
                width: var(--pipeline-seg-hit) !important;
                height: var(--pipeline-seg-hit) !important;
            }

            /* Pipeline container - extra compact on small mobile */
            .mt-16 > div[style*="max-width: 1100px"] > div[style*="border-radius: 0.75rem"] {
                padding: 0.375rem !important;
            }

            /* Pipeline description - even smaller on tiny screens */
            #pipelineDescription {
                font-size: 0.65rem !important;
                margin-top: 0.5rem !important;
            }

            /* Reduce gap further on small screens */
            div[style*="display: flex"][style*="gap: 1rem"] {
                gap: 0.375rem !important;
            }
        }

        /* Tablets and small laptops */
        @media (min-width: 769px) and (max-width: 1024px) {
            /* Slightly reduce text sizes for tablets */
            h1 {
                font-size: 3.5rem !important;
            }

            .table-wrapper,
            .overflow-x-auto {
                overflow-x: auto;
                -webkit-overflow-scrolling: touch;
            }
        }

        /* Mobile-specific scaling for grid containers */
        @media (max-width: 768px) {
            /* Codec-Style: 2x2 responsive grid layout on mobile */
            #image-grid-codec {
                transform-origin: top center !important;
                transform: none !important;
                width: 100% !important;
                margin: 0 auto 2rem auto !important;
                display: grid !important;
                grid-template-columns: repeat(2, 1fr) !important;
                gap: 1rem !important;
                justify-content: center !important;
                align-items: start !important;
                overflow: hidden !important;
            }
            
            #image-grid-codec .codec-block-wrapper {
                position: relative !important;
                left: auto !important;
                width: 100% !important;
                height: auto !important;
                transform: none !important;
                display: flex;
                flex-direction: column;
                align-items: center;
                justify-content: center;
                overflow: visible !important;
            }
            
            /* Scale the inner grid to fit */
            #image-grid-codec .codec-block-wrapper > div:first-child {
                max-width: 100% !important;
                transform-origin: top center !important;
            }
            
            /* Traditional Sampling: 2x2 responsive grid ONLY on mobile */
            #image-grid-sampling {
                transform-origin: top center !important;
                transform: none !important;
                width: 100% !important;
                margin: 0 auto 2rem auto !important;
                display: grid !important;
                grid-template-columns: repeat(2, 1fr) !important;
                gap: 1rem !important;
                justify-content: center !important;
                align-items: start !important;
                overflow: hidden !important;
            }
            
            #image-grid-sampling .sampling-frame-wrapper {
                position: relative !important;
                left: auto !important;
                top: auto !important;
                width: 100% !important;
                height: auto !important;
                display: flex;
                flex-direction: column;
                align-items: center;
            }

            /* Improve table mobile experience - override ::after with ::before */
            .overflow-x-auto {
                border-radius: 0.5rem;
                box-shadow: 0 1px 3px 0 rgba(0, 0, 0, 0.1);
                margin-bottom: 1rem;
                background: #0369a1;
            }

            /* Add scrollable table hint at top (overrides default ::after) */
            .overflow-x-auto::before {
                content: '→ Swipe to view full table →';
                display: block;
                text-align: center;
                padding: 0.5rem;
                background: linear-gradient(135deg, #075985 0%, #0369a1 100%);
                color: #fed7aa;
                font-size: 0.75rem;
                font-weight: 600;
                border-radius: 0.5rem 0.5rem 0 0;
                letter-spacing: 0.05em;
            }

            /* Hide the bottom scroll hint on mobile (since we have top hint) */
            /* Overrides the default ::after scroll indicator from line 405-418 */
            .overflow-x-auto::after {
                display: none;
            }

            /* Better table cell sizing on mobile - consolidated sticky-col rules */
            .data-table th,
            .data-table td {
                font-size: 0.7rem !important;
                padding: 6px 8px !important;
                white-space: nowrap;
            }
            
            /* Pipeline labels responsive font sizing */
            .pipeline-label {
                font-size: 0.46rem !important;
                padding: 0 0.125rem !important;
                line-height: 1.2 !important;
            }

            .data-table .sticky-col {
                min-width: 120px !important;
                max-width: 120px !important;
                box-shadow: 3px 0 8px rgba(0, 0, 0, 0.15) !important;
                background-color: #0369a1 !important;
            }
        }

        @media (max-width: 480px) {
            /* More compact 2x2 grid for very small screens */
            #image-grid-codec {
                gap: 0.75rem !important;
            }

            /* Remove fixed scaling - JavaScript handles sizing */
            #image-grid-codec .codec-block-wrapper > div[style*="position: absolute"] {
                transform: none !important;
            }
            
            #image-grid-sampling {
                transform: none !important;
            }

            /* Even smaller table text for tiny screens */
            .data-table th,
            .data-table td {
                font-size: 0.65rem !important;
                padding: 4px 6px !important;
            }

            .data-table .sticky-col {
                min-width: 100px !important;
                max-width: 100px !important;
            }
        }

        /* Tablet optimization: avoid fighting JS-driven layout */
        @media (min-width: 769px) and (max-width: 1024px) {
            #image-grid-codec,
            #image-grid-sampling {
                overflow-x: auto;
                -webkit-overflow-scrolling: touch;
            }
        }

        /* ------------------------------------------------------------------
           Pipeline navigation polish (arrows + segmented indicator)
           ------------------------------------------------------------------ */
        #pipelinePrevBtn,
        #pipelineNextBtn {
            --pipeline-arrow-hit: 44px;
            --pipeline-arrow-chip: 34px;
            --pipeline-arrow-radius: 12px;

            position: relative;
            width: var(--pipeline-arrow-hit);
            height: var(--pipeline-arrow-hit);
            min-width: var(--pipeline-arrow-hit);
            min-height: var(--pipeline-arrow-hit);
            background: transparent;
            border: 0;
            border-radius: 9999px;
            padding: 0;
            transition: transform 160ms ease;
        }

        #pipelinePrevBtn::before,
        #pipelineNextBtn::before {
            content: '';
            position: absolute;
            left: 50%;
            top: 50%;
            width: var(--pipeline-arrow-chip);
            height: var(--pipeline-arrow-chip);
            transform: translate(-50%, -50%);
            border-radius: var(--pipeline-arrow-radius);
            background: rgba(254, 215, 170, 0.06);
            box-shadow: 0 0 0 1px rgba(254, 215, 170, 0.18);
            transition: background-color 160ms ease, box-shadow 160ms ease;
        }

        #pipelinePrevBtn:hover::before,
        #pipelineNextBtn:hover::before {
            background: rgba(254, 215, 170, 0.12);
            box-shadow: 0 0 0 1px rgba(254, 215, 170, 0.26), 0 10px 18px -10px rgba(0, 0, 0, 0.35);
        }

        #pipelinePrevBtn:hover,
        #pipelineNextBtn:hover {
            transform: translateY(-1px);
        }

        #pipelinePrevBtn i,
        #pipelineNextBtn i {
            position: relative;
            z-index: 1;
        }

        #pipelinePrevBtn:focus-visible,
        #pipelineNextBtn:focus-visible {
            outline: none;
            box-shadow: 0 0 0 2px rgba(254, 215, 170, 0.22);
        }

        @media (max-width: 768px) {
            #pipelinePrevBtn,
            #pipelineNextBtn {
                --pipeline-arrow-hit: 40px;
                --pipeline-arrow-chip: 30px;
                --pipeline-arrow-radius: 11px;
            }
        }

        @media (max-width: 480px) {
            #pipelinePrevBtn,
            #pipelineNextBtn {
                --pipeline-arrow-hit: 38px;
                --pipeline-arrow-chip: 28px;
                --pipeline-arrow-radius: 10px;
            }
        }

        #pipelineDots {
            --pipeline-seg-hit: 40px;
            --pipeline-seg-w: 14px;
            --pipeline-seg-w-active: 22px;
            --pipeline-seg-h: 2px;
            --pipeline-seg-bg: rgba(254, 215, 170, 0.22);
            --pipeline-seg-bg-hover: rgba(254, 215, 170, 0.35);
            --pipeline-seg-bg-active: rgba(254, 215, 170, 0.95);
            --pipeline-seg-stroke: rgba(254, 215, 170, 0.16);
            --pipeline-seg-stroke-active: rgba(254, 215, 170, 0.55);
        }

        #pipelineDots button {
            width: var(--pipeline-seg-hit);
            height: var(--pipeline-seg-hit);
            min-width: 0;
            min-height: 0;
            padding: 0;
            margin: 0;
            border: 0;
            background: transparent;
            border-radius: 9999px;
            cursor: pointer;
            display: grid;
            place-items: center;
        }

        #pipelineDots button::before {
            content: '';
            width: var(--pipeline-seg-w);
            height: var(--pipeline-seg-h);
            border-radius: 9999px;
            background: var(--pipeline-seg-bg);
            box-shadow: 0 0 0 1px var(--pipeline-seg-stroke);
            transition: width 160ms ease, background-color 160ms ease, box-shadow 160ms ease;
        }

        #pipelineDots button:hover::before {
            background: var(--pipeline-seg-bg-hover);
        }

        #pipelineDots button[aria-current='true']::before {
            width: var(--pipeline-seg-w-active);
            background: var(--pipeline-seg-bg-active);
            box-shadow: 0 0 0 1px var(--pipeline-seg-stroke-active);
        }

        #pipelineDots button:focus-visible {
            outline: none;
            box-shadow: 0 0 0 2px rgba(254, 215, 170, 0.22);
        }

        @media (max-width: 768px) {
            #pipelineDots {
                --pipeline-seg-hit: 36px;
                --pipeline-seg-w: 12px;
                --pipeline-seg-w-active: 18px;
            }
        }

        @media (max-width: 480px) {
            #pipelineDots {
                --pipeline-seg-hit: 34px;
                --pipeline-seg-w: 10px;
                --pipeline-seg-w-active: 16px;
            }
        }
    </style>
</head>
<body class="text-[#fed7aa] bg-[#0369a1]">

    <nav class="w-full z-50 bg-[#0369a1] border-b border-[#fed7aa]/10" style="padding: 1.5rem 0;">
        <div style="display: flex; align-items: center; justify-content: space-between; width: 100%; max-width: 80rem; margin: 0 auto; padding: 0 2rem;">
            <div style="display: flex; align-items: center;">
                <a href="/" style="display: block; line-height: 0; text-decoration: none;">
                    <img src="/assets/logo.png" alt="LMMs-Lab Logo" style="width: auto; height: 44px; object-fit: contain;">
                </a>
            </div>
            
            <!-- Desktop Navigation -->
            <div class="hidden md:flex" style="gap: 2rem; align-items: center;">
                <a href="/" style="font-size: 1rem; font-weight: 500; text-transform: uppercase; letter-spacing: 0.05em; color: #fed7aa; text-decoration: none; opacity: 0.6; transition: opacity 200ms;">HOME</a>
                <a href="/posts" style="font-size: 1rem; font-weight: 500; text-transform: uppercase; letter-spacing: 0.05em; color: #fed7aa; text-decoration: none; opacity: 0.6; transition: opacity 200ms;">POSTS</a>
                <a href="/notes" style="font-size: 1rem; font-weight: 500; text-transform: uppercase; letter-spacing: 0.05em; color: #fed7aa; text-decoration: none; opacity: 0.6; transition: opacity 200ms;">NOTES</a>
                <a href="/about" style="font-size: 1rem; font-weight: 500; text-transform: uppercase; letter-spacing: 0.05em; color: #fed7aa; text-decoration: none; opacity: 0.6; transition: opacity 200ms;">ABOUT</a>
            </div>

            <!-- Mobile Menu Button -->
            <button class="md:hidden mobile-menu-button" id="mobileMenuBtn" aria-label="Toggle mobile menu" style="color: #fed7aa;">
                <i class="fa-solid fa-bars"></i>
            </button>
        </div>
        <!-- Mobile Navigation Menu -->
        <div class="mobile-nav md:hidden" id="mobileMenu">
            <a href="/" class="nav-link">HOME</a>
            <a href="/posts" class="nav-link">POSTS</a>
            <a href="/notes" class="nav-link">NOTES</a>
            <a href="/about" class="nav-link">ABOUT</a>
        </div>
    </nav>

    <!-- Hero Section -->
    <div class="hero-bg pt-32 pb-20 sm:pt-40 sm:pb-28">
        <div class="max-w-5xl mx-auto px-4 sm:px-6 lg:px-8 text-center">
            <h1 class="text-5xl sm:text-7xl font-bold text-[#fed7aa] tracking-tight mb-8 leading-tight">
                <span class="gradient-text">OneVision Encoder</span>
            </h1>
            <p class="text-xl sm:text-2xl text-[#fed7aa]/90 font-light mb-6">
                The first HEVC style Vision Transformer with advanced multimodal capabilities
            </p>

            <div class="mt-8 text-base text-[#fed7aa]/70">
                <p class="font-medium">LMMs Lab, Glint Lab, AIM for Health Lab, MVP Lab</p>
            </div>
        </div>
    </div>

    <!-- Introduction Section -->
    <section id="abstract" class="py-16 bg-[#0369a1]">
        <div class="max-w-6xl mx-auto px-4 sm:px-6 lg:px-8">
            <h3 class="text-2xl font-bold text-[#fed7aa] mb-4">Introduction</h3>
            <p class="text-[#fed7aa]/90 text-base mb-4">
                <strong>Hypothesis.</strong> Artificial general intelligence is, at its core, a compression problem. Effective compression demands resonance: deep learning scales best when its architecture aligns with the fundamental structure of the data. These are the fundamental principles. Yet, modern vision architectures have strayed from these truths: visual signals are highly redundant, while discriminative information, the <em>surprise</em>, is sparse. Current models process dense pixel grids uniformly, wasting vast compute on static background rather than focusing on the predictive residuals that define motion and meaning. We argue that to solve visual understanding, we must align our architectures with the information-theoretic principles of video, i.e., Codecs.
            </p>
            <p class="text-[#fed7aa]/90 text-base mb-4">
                <strong>Method.</strong> OneVision-Encoder encodes video by compressing predictive visual structure into semantic meaning. By adopting Codec Patchification, OneVision-Encoder abandons uniform computation to focus exclusively on the 3.1%-25% of regions rich in signal entropy. To unify spatial and temporal reasoning under irregular token layouts, OneVision-Encoder employs a shared 3D RoPE and is trained with a large-scale cluster discrimination objective over more than one million semantic concepts, jointly capturing object permanence and motion dynamics.
            </p>
            <p class="text-[#fed7aa]/90 text-base mb-6">
                <strong>Evidence.</strong> The results validate our core hypothesis: efficiency and accuracy are not a trade-off; they are positively correlated. By resolving the dichotomy between dense grids and sparse semantics, OneVision-Encoder redefines the performance frontier. When integrated into large multimodal models, it consistently outperforms strong vision backbones such as Qwen3-ViT and SigLIP2 across 16 image, video, and document understanding benchmarks, despite using substantially fewer visual tokens and pretraining data. Notably, on video understanding tasks, OneVision-Encoder achieves an average improvement of 4.1% over Qwen3-ViT. Under attentive probing, it achieves state-of-the-art representation quality, with 17.1% and 8.1% Top-1 accuracy improvements over SigLIP2 and DINOv3, respectively, on Diving-48 under identical patch budgets. These results demonstrate that codec-aligned, patch-level sparsity is not an optimization trick, but a foundational principle for next-generation visual generalists, positioning OneVision-Encoder as a scalable engine for universal multimodal intelligence.
            </p>
            <figure class="mt-8 mb-12 flex flex-col items-center">
                <img src="images/method.png" alt="OneVision Encoder Method Overview" class="block w-full max-w-4xl rounded-lg">
                <!-- <figcaption class="text-center text-[#fed7aa]/70 text-xs mt-4 italic max-w-3xl">
                    Overview of the OneVision Encoder architecture: Dense video-codec decomposition, chunk-wise sampling, and contrastive learning with class embeddings.
                 </figcaption> -->
            </figure>
        </div>
    </section>

    <!-- Method Section -->
    <!-- <section id="method" class="py-20 bg-[#0369a1]"> -->
        <div class="max-w-6xl mx-auto px-4 sm:px-6 lg:px-8">

            <!-- Tooltip for position display -->
            <div id="position-tooltip" style="position: fixed; background-color: #111827; color: white; padding: 0.5rem 0.75rem; font-size: 0.875rem; border-radius: 0.25rem; box-shadow: 0 10px 15px -3px rgba(0, 0, 0, 0.1); pointer-events: none; opacity: 0; transition: opacity 0.2s; z-index: 50;">
                <span id="tooltip-text">-</span>
            </div>

            <!-- 1. Codec-Style Patch Selection (Core Insight) -->
            <div>
                <h3 class="text-2xl font-bold text-[#fed7aa] mb-4">
                    Codec-Style Patch Selection
                </h3>
                <p class="text-[#fed7aa]/90 text-base mb-4">
                    Traditional video understanding models process frames by uniform temporal sampling—selecting evenly-spaced frames regardless of content. This approach treats all spatial regions equally, wasting computation on redundant background pixels that remain static across frames.
                </p>
                <p class="text-[#fed7aa]/90 text-base mb-6">
                    Inspired by HEVC video compression, our <strong>codec-style approach</strong> identifies and processes only the patches that carry meaningful temporal changes. Just as video codecs encode motion vectors and residuals rather than full frames, we select patches based on their information density—preserving the dynamic, semantically-rich regions while discarding redundant static content.
                </p>

                <!-- Codec Style Input Grid -->
                <div class="bg-[#0369a1] rounded-xl p-4 sm:p-6 mb-6">
                    <h4 class="text-base sm:text-lg font-semibold text-[#fed7aa] mb-2 text-center">
                        Codec-Style Input
                    </h4>
                    <p class="text-[#fed7aa]/70 text-xs text-left mb-4">
                        Left: Reference frame (t=1) with all patches. Right: Three animated blocks showing consecutive frames (t=2,3,4 → t=5,6,7 → ...), cycling through t=2 to t=64. Each frame shows only salient patches at their spatial positions. The result: <strong>75-98% fewer patches</strong> while retaining the information that matters.
                    </p>
                    <div id="image-grid-codec" style="display: block; margin: 0 auto 2rem auto; padding-top: 20px; overflow: hidden;">
                        <!-- Grid will be generated by JavaScript -->
                    </div>
                </div>

                <!-- Sampling Frame Input Grid -->
                <div class="bg-[#0369a1] rounded-xl p-4 sm:p-6">
                    <h4 class="text-base sm:text-lg font-semibold text-[#fed7aa] mb-2 text-center">
                        Traditional Frame Sampling
                    </h4>
                    <p class="text-[#fed7aa]/70 text-xs text-left mb-4">
                        Uniformly samples 4 frames and processes all patches from each. Notice the redundancy: static backgrounds, repeated textures, and unchanging regions are processed multiple times across frames—wasting computation on pixels that add no new information.
                    </p>
                    <div id="image-grid-sampling" style="display: block; margin: 0 auto 2rem auto; padding-top: 20px; overflow: hidden;">
                        <!-- Grid will be generated by JavaScript -->
                    </div>
                </div>
            </div>


            <!-- 2. Video Processing Pipeline -->
            <div class="mt-16">
                <h3 class="text-2xl font-bold text-[#fed7aa] mb-4">
                    Video Processing Pipeline
                </h3>
                <p class="text-[#fed7aa]/90 text-sm mb-6">
                    The visualization below demonstrates our complete video processing pipeline. The animation shows four key stages: (1) <strong>Original Video</strong> - a continuous 64-frame stream capturing the full temporal context, (2) <strong>Uniform Frame Sampling</strong> - traditional approach selecting 4-8 evenly-spaced frames, which is simple but lossy and misses inter-frame motion, (3) <strong>Temporal Saliency Detection</strong> - analysis of all 64 frames to identify regions with high temporal information such as motion, appearance changes, and semantic events, and (4) <strong>Codec-Style Patch Extraction</strong> - extraction of only the salient patches in zigzag order, achieving 75-98% compression while preserving temporal dynamics.
                </p>

                <!-- Interactive GIF Display with Case Switching -->
                <div style="max-width: 1100px; margin: 0 auto;">
                    <!-- Outer frame containing both labels and video -->
                    <div style="border-radius: 0.75rem; padding: 1rem; box-shadow: 0 4px 6px -1px rgba(0, 0, 0, 0.1), 0 2px 4px -1px rgba(0, 0, 0, 0.06); background: #0369a1; border: 1px solid rgba(254, 215, 170, 0.2);">
                        <!-- Labels Row - positioned above video container -->
                        <div class="pipeline-labels" style="display: flex; flex-direction: row; justify-content: space-around; align-items: center; margin-bottom: 0.75rem; padding: 0 0.5rem; flex-wrap: nowrap;">
                            <div class="pipeline-label" style="flex: 1; text-align: center; font-size: 0.875rem; font-weight: 600; color: #fed7aa; white-space: nowrap; padding: 0 0.25rem;">Original Video</div>
                            <div class="pipeline-label" style="flex: 1; text-align: center; font-size: 0.875rem; font-weight: 600; color: #fed7aa; white-space: nowrap; padding: 0 0.25rem;">Uniform Frame Sampling</div>
                            <div class="pipeline-label" style="flex: 1; text-align: center; font-size: 0.875rem; font-weight: 600; color: #fed7aa; white-space: nowrap; padding: 0 0.25rem;">Temporal Saliency Detection</div>
                            <div class="pipeline-label" style="flex: 1; text-align: center; font-size: 0.875rem; font-weight: 600; color: #fed7aa; white-space: nowrap; padding: 0 0.25rem;">Codec-Style Patch Extraction</div>
                        </div>
                        <div id="pipelineGifContainer" style="position: relative; border-radius: 0.5rem; overflow: hidden;">
                            <video id="pipelineGifImage" src="images/case1.webm" autoplay loop muted playsinline style="width: 100%; height: auto; border-radius: 0.5rem; display: block; transition: opacity 0.3s ease;"></video>
                        </div>
                    </div>

                    <p id="pipelineDescription" class="text-center text-[#fed7aa]/70 text-xs mt-4 italic max-w-3xl mx-auto">
                        Complete video processing pipeline showing the four stages from original video to codec-style compressed representation. Each stage demonstrates how our approach progressively identifies and extracts temporally-salient patches while maintaining rich motion information.
                    </p>
                </div>

                <!-- Pagination Dots with Arrows -->
                <div style="display: flex; justify-content: center; align-items: center; gap: 1rem; margin-top: 1.5rem;">
                    <!-- Left Arrow -->
                    <button id="pipelinePrevBtn" aria-label="Previous case" style="display: flex; align-items: center; justify-content: center; cursor: pointer; transition: all 0.2s ease;">
                        <i class="fa-solid fa-chevron-left" style="color: #fed7aa; font-size: 1rem;"></i>
                    </button>

                    <div id="pipelineDots" style="display: flex; justify-content: center; gap: 0.75rem; align-items: center;">
                        <!-- Dots will be inserted here by JavaScript -->
                    </div>

                    <!-- Right Arrow -->
                    <button id="pipelineNextBtn" aria-label="Next case" style="display: flex; align-items: center; justify-content: center; cursor: pointer; transition: all 0.2s ease;">
                        <i class="fa-solid fa-chevron-right" style="color: #fed7aa; font-size: 1rem;"></i>
                    </button>
                </div>

                <!-- <p class="text-center text-[#fed7aa]/70 text-xs mt-6 italic max-w-2xl mx-auto">
                    Key insight: By processing dense frames sparsely (selecting important patches) rather than sparse frames densely (processing all patches), we capture richer temporal information with less computation.
                </p> -->
            </div>

            <!-- 3. Global Contrastive Learning -->
            <div class="mt-16">
                <h3 class="text-2xl font-bold text-[#fed7aa] mb-4">
                    Global Contrastive Learning
                </h3>
                <p class="text-[#fed7aa]/90 text-base mb-4">
                    Standard contrastive learning (e.g., CLIP) is limited by batch size—negative samples are drawn only from the current batch, typically 32K-64K examples. This creates a narrow view of the embedding space and leads to suboptimal representations. Our approach maintains a <strong>global concept bank of 2M clustered centers</strong>, enabling each training sample to contrast against a diverse, representative set of negatives regardless of batch composition. This produces more discriminative embeddings with better-separated semantic clusters.
                </p>
                <figure class="figure-centered flex-col">
                    <video src="images/global_contrastive_comparison.webm" autoplay loop muted playsinline class="w-full max-w-5xl rounded-lg"></video>
                    <!-- <figcaption class="text-center text-[#fed7aa]/70 text-xs mt-4 italic max-w-3xl">
                        Left: CLIP's batch-level contrastive learning with limited negatives. Right: Our global contrastive approach with clustered positive centers (green) contrasting against 60 diverse negative samples (red/orange) drawn from a 2M concept bank.
                    </figcaption> -->
                </figure>
            </div>

        </div>

        <div class="max-w-6xl mx-auto px-4 sm:px-6 lg:px-8">
            <!-- <h2 class="text-3xl font-bold text-[#fed7aa] mb-10 text-center">Experimental Results</h2> -->

            <!-- Experimental Details -->
            <!-- <div class="mb-12 bg-[#0369a1] border-l-4 border-slate-900 p-6 rounded-r">
                <h3 class="text-lg font-semibold text-[#fed7aa] mb-3 flex items-center">
                    <i class="fa-solid fa-flask mr-2 text-slate-700"></i>Experimental Setup
                </h3>
                <p class="text-[#fed7aa]/90 leading-relaxed text-sm">
                    Our experiments utilize an 8-frame full attention input mechanism with comprehensive training on 740K samples from LLaVA-NeXT and 800K samples from LLaVA-Video SFT datasets. The training pipeline bypasses Stage 1.5 and proceeds directly to Stage 2 fine-tuning. We implement a streamlined native resolution strategy based on LLaVA-NeXT's resolution matching approach: when a resolution match is found, frames are directly input to the model without image tiling or cropping, maintaining spatial integrity while ensuring computational efficiency.
                </p>
            <!-- </div> -->


            <div class="mt-8">
                <h3 class="text-2xl font-bold text-[#fed7aa] mb-4">LMM Probe Results</h3>
                <p class="text-[#fed7aa]/90 mb-6 text-base">
                    <span class="font-bold">Comparison of different vision encoders on multimodal benchmarks.</span> All models are evaluated on a unified multimodal setting using Qwen3-4B-Instruct2507 as the language backbone. OV-Encoder-Lang denotes the language-aligned variant of the OV-Encoder architecture. Qwen3-ViT is extracted from Qwen3-VL-4B. SigLIP2 uses siglip2-so400m-patch16-naflex. <span class="font-bold">(Codec)</span> indicates codec-guided visual encoding using motion vectors and residual signals, while <span class="font-bold">(Frame)</span> indicates frame-based visual encoding with dense spatial patchification. Bold values indicate the best performance under the same evaluation setting. Results reported in the left columns correspond to encoders trained with caption supervision, whereas results in the right columns correspond to encoders trained without caption supervision.                </p>
                <div class="table-wrapper">
                    <table class="results-table" style="float:left;">
                        <thead>
                            <tr>
                                <th rowspan="2" style="vertical-align: middle; min-width: 140px;">Task</th>
                                <th rowspan="2" style="vertical-align: middle; min-width: 220px;">Benchmark</th>
                                <th colspan="5" style="min-width: 140px;">Qwen3-4B-Instruct2507</th>
                            </tr>
                            <tr class="sub-header">
                                <th class="highlight-ours" style="min-width: 140px;">OV-Encoder-Lang<br><span class="font-bold">(Codec)</span></th>
                                <th style="min-width: 140px;">Qwen3-ViT<br><span class="font-bold">(Frame)</span></th>
                                <th class="highlight-ours separator-left" style="min-width: 140px;">OV-Encoder<br><span class="font-bold">(Codec)</span></th>
                                <th style="min-width: 140px;">OV-Encoder-Frame<br><span class="font-bold">(Frame)</span></th>
                                <th style="min-width: 140px;">SigLIP2<br><span class="font-bold">(Frame)</span></th>
                            </tr>
                        </thead>
                        <tbody>
                            <!-- Video Tasks -->
                            <tr>
                                <td rowspan="7" class="task-group-cell">Video</td>
                                <td class="row-header">MVBench</td>
                                <td class="best-val highlight-ours">53.2</td>
                                <td>47.4</td>
                                <td class="best-val highlight-ours separator-left">52.4</td>
                                <td>49.8</td>
                                <td>47.2</td>
                            </tr>
                            <tr>
                                <td class="row-header">MLVU-dev</td>
                                <td class="best-val highlight-ours">47.4</td>
                                <td>47.2</td>
                                <td class="highlight-ours separator-left">46.3</td>
                                <td class="best-val">49.4</td>
                                <td>48.4</td>
                            </tr>
                            <tr>
                                <td class="row-header">NExT-QA (MC)</td>
                                <td class="best-val highlight-ours">76.1</td>
                                <td>70.1</td>
                                <td class="best-val highlight-ours separator-left">75.6</td>
                                <td>71.9</td>
                                <td>70.6</td>
                            </tr>
                            <tr>
                                <td class="row-header">VideoMME</td>
                                <td class="best-val highlight-ours">54.1</td>
                                <td>47.2</td>
                                <td class="best-val highlight-ours separator-left">53.4</td>
                                <td>49.3</td>
                                <td>46.8</td>
                            </tr>
                            <tr>
                                <td class="row-header">Perception Test</td>
                                <td class="best-val highlight-ours">60.6</td>
                                <td>57.1</td>
                                <td class="best-val highlight-ours separator-left">60.3</td>
                                <td>56.7</td>
                                <td>56.0</td>
                            </tr>
                            <tr>
                                <td class="row-header">TOMATO</td>
                                <td class="highlight-ours">21.8</td>
                                <td class="best-val">22.2</td>
                                <td class="highlight-ours separator-left">22.2</td>
                                <td>21.8</td>
                                <td class="best-val">22.3</td>
                            </tr>
                            <tr>
                                <td class="row-header">LongVideoBench-Val-Video</td>
                                <td class="best-val highlight-ours">51.6</td>
                                <td>45.0</td>
                                <td class="best-val highlight-ours separator-left">50.4</td>
                                <td>45.5</td>
                                <td>45.2</td>
                            </tr>
                            <!-- Image Tasks -->
                            <tr>
                                <td rowspan="9" class="task-group-cell">Image</td>
                                <td class="row-header">AI2D</td>
                                <td class="best-val highlight-ours">80.2</td>
                                <td>77.8</td>
                                <td class="highlight-ours separator-left">75.7</td>
                                <td>76.5</td>
                                <td class="best-val">78.6</td>
                            </tr>
                            <tr>
                                <td class="row-header">ChartQA</td>
                                <td class="best-val highlight-ours">80.1</td>
                                <td>79.6</td>
                                <td class="highlight-ours separator-left">76.5</td>
                                <td class="best-val">77.8</td>
                                <td>76.4</td>
                            </tr>
                            <tr>
                                <td class="row-header">DocVQA</td>
                                <td class="highlight-ours">83.2</td>
                                <td class="best-val">85.1</td>
                                <td class="highlight-ours separator-left">78.4</td>
                                <td class="best-val">79.5</td>
                                <td>75.0</td>
                            </tr>
                            <tr>
                                <td class="row-header">InfoVQA</td>
                                <td class="best-val highlight-ours">51.6</td>
                                <td>49.0</td>
                                <td class="highlight-ours separator-left">43.1</td>
                                <td class="best-val">45.5</td>
                                <td>42.0</td>
                            </tr>
                            <tr>
                                <td class="row-header">MMBench-EN</td>
                                <td class="best-val highlight-ours">80.2</td>
                                <td>79.4</td>
                                <td class="highlight-ours separator-left">77.2</td>
                                <td>78.5</td>
                                <td class="best-val">79.6</td>
                            </tr>
                            <tr>
                                <td class="row-header">OCRBench</td>
                                <td class="highlight-ours">657</td>
                                <td class="best-val">706</td>
                                <td class="highlight-ours separator-left">605</td>
                                <td class="best-val">630</td>
                                <td>621</td>
                            </tr>
                            <tr>
                                <td class="row-header">OCRBench v2</td>
                                <td class="best-val highlight-ours">30.8</td>
                                <td>30.6</td>
                                <td class="best-val highlight-ours separator-left">26.3</td>
                                <td>26.1</td>
                                <td>26.1</td>
                            </tr>
                            <tr>
                                <td class="row-header">MMStar</td>
                                <td class="best-val highlight-ours">56.6</td>
                                <td class="best-val">56.6</td>
                                <td class="highlight-ours separator-left">52.1</td>
                                <td>54.3</td>
                                <td class="best-val">55.0</td>
                            </tr>
                            <tr>
                                <td class="row-header">RealWorldQA</td>
                                <td class="best-val highlight-ours">66.1</td>
                                <td>63.3</td>
                                <td class="highlight-ours separator-left">60.8</td>
                                <td>61.2</td>
                                <td class="best-val">62.1</td>
                            </tr>
                        </tbody>
                    </table>
                </div>

                <p class="text-xs text-[#fed7aa]/70 mt-2 text-left">
                    * Bold values indicate the best performance under the same evaluation setting.
                </p>
            </div>

                            

            <!-- Attentive Probe Results Section -->
            <div class="mt-8">
                                <h3 class="text-2xl font-bold text-[#fed7aa] mb-4">Attentive Probe Results</h3>
                                <p class="text-[#fed7aa]/90 mb-6 text-base">
                                    Performance comparison of different vision encoders using Attentive Probe evaluation. Models are evaluated using <strong>single clip</strong> input and trained for <strong>10 epochs</strong> across 8 action recognition datasets. Results show average performance and per-dataset scores for 8-frame and 16-frame configurations.
                                </p>
                                <p class="text-[#fed7aa]/90 mb-6 text-base">
                                OV-Encoder (Codec) refers to a variant of OV-Encoder that replaces traditional frame sampling with codec-style input, where dense full-frame inputs are substituted by codec-guided patch reorganization. Under the same attentive probe setting and token budget, patches are selectively reallocated across the input clip based on codec-native motion vectors and residuals, without changing the backbone architecture or training protocol. This results in stronger performance on motion-sensitive datasets, particularly Diving48 and Perception Test.</p>
                                </p>
                                <div class="table-wrapper">
                                <table class="results-table" style="float:left;">
                                    <colgroup>
                                        <col style="width:25%">
                                        <col style="width:10.71%">
                                        <col style="width:6.79%">
                                        <col style="width:6.79%">
                                        <col style="width:6.79%">
                                        <col style="width:6.79%">
                                        <col style="width:6.79%">
                                        <col style="width:6.79%">
                                        <col style="width:6.79%">
                                        <col style="width:6.79%">
                                        <col style="width:6.79%">
                                        <col style="width:6.79%">
                                    </colgroup>
                                    <thead>
                                        <tr>
                                            <th scope="col" class="sticky-col">Method</th>
                                            <th scope="col">Arch.</th>
                                            <th scope="col">Res.</th>
                                            <th scope="col">AVG</th>
                                            <th scope="col">SSV2</th>
                                            <th scope="col">Diving48</th>
                                            <th scope="col">Perce. Test</th>
                                            <th scope="col">CharEgo</th>
                                            <th scope="col">Epic Verb</th>
                                            <th scope="col">Epic Noun</th>
                                            <th scope="col">K400</th>
                                            <th scope="col">HMDB51</th>
                                        </tr>
                                    </thead>
                                    <tbody>

                                        <!-- Group: 8 Frames -->
                                        <tr class="section-header">
                                            <td colspan="12">
                                                <i class="fa-solid fa-film mr-2 text-[#fed7aa]/60"></i> 8 Frames
                                            </td>
                                        </tr>
                                        <tr>
                                            <td class="sticky-col">MetaCLIP2</td>
                                            <td>ViT-L/14</td><td>224</td><td class="row-avg">46.3</td>
                                            <td>45.9</td><td>30.7</td><td>46.4</td><td>10.2</td><td>44.4</td><td>36.6</td><td>79.1</td><td>77.0</td>
                                        </tr>
                                        <tr>
                                            <td class="sticky-col">AIMv2</td>
                                            <td>ViT-L/14</td><td>224</td><td class="row-avg">52.6</td>
                                            <td>53.8</td><td>45.3</td><td>52.9</td><td>11.5</td><td>54.4</td><td>42.7</td><td>79.0</td><td>81.5</td>
                                        </tr>

                                        <tr>
                                            <td class="sticky-col">DINOv3</td>
                                            <td>ViT-L/14</td><td>224</td><td class="row-avg">56.0</td>
                                            <td>56.1</td><td>50.7</td><td>58.1</td><td>12.4</td><td>60.0</td><td>47.9</td><td>81.4</td><td>81.4</td>
                                        </tr>

                                        <tr>
                                            <td class="sticky-col">SigLIP2</td>
                                            <td>ViT-L/16</td><td>256</td><td class="row-avg">56.0</td>
                                            <td>57.9</td><td>53.2</td><td>56.3</td><td class="best-val">12.8</td><td>58.8</td><td>45.2</td><td>81.3</td><td>82.1</td>
                                        </tr>

                                        <tr>
                                            <td class="sticky-col">
                                                OV-Encoder <span class="text-[10px] font-normal opacity-80">(Frame)</span>
                                            </td>
                                            <td>ViT-L/14</td><td>224</td><td class="row-avg">58.4</td>
                                            <td>57.7</td><td>57.6</td><td>58.3</td><td>12.1</td><td>61.4</td><td>52.5</td><td>84.3</td><td>83.1</td>
                                        </tr>
                                        <tr>
                                            <td class="sticky-col">
                                                OV-Encoder <span class="text-[10px] font-normal opacity-80">(Codec)</span>
                                            </td>
                                            <td>ViT-L/14</td><td>224</td><td class="best-val">60.2</td>
                                            <td class="best-val">58.5</td><td class="best-val">67.2</td><td class="best-val">60.0</td><td>12.3</td><td class="best-val">62.3</td><td class="best-val">53.9</td><td class="best-val">84.4</td><td class="best-val">83.4</td>
                                        </tr>

                                        <!-- Group: 16 Frames -->
                                        <tr class="section-header">
                                            <td colspan="12">
                                                <i class="fa-solid fa-film mr-2 text-[#fed7aa]/60"></i> 16 Frames
                                            </td>
                                        </tr>
                                        <tr>
                                            <td class="sticky-col">MetaCLIP2</td>
                                            <td>ViT-L/14</td><td>224</td><td class="row-avg">49.7</td>
                                            <td>51.6</td><td>47.1</td><td>47.3</td><td>10.4</td><td>49.0</td><td>35.7</td><td>80.1</td><td>76.1</td>
                                        </tr>
                                        <tr>
                                            <td class="sticky-col">AIMv2</td>
                                            <td>ViT-L/14</td><td>224</td><td class="row-avg">53.7</td>
                                            <td>54.8</td><td>50.0</td><td>55.0</td><td>12.2</td><td>55.0</td><td>42.1</td><td>79.3</td><td>80.9</td>
                                        </tr>
                                        <tr>
                                            <td class="sticky-col">DINOv3</td>
                                            <td>ViT-L/14</td><td>224</td><td class="row-avg">57.7</td>
                                            <td>57.8</td><td>61.1</td><td>57.5</td><td>12.2</td><td>61.3</td><td>48.8</td><td>82.6</td><td>79.8</td>
                                        </tr>
                                        <tr>
                                            <td class="sticky-col">SigLIP2</td>
                                            <td>ViT-L/16</td><td>256</td><td class="row-avg">57.3</td>
                                            <td>59.6</td><td>59.1</td><td>56.0</td><td class="best-val">13.1</td><td>59.3</td><td>46.2</td><td>82.5</td><td>82.3</td>
                                        </tr>                        <tr>
                                            <td class="sticky-col">
                                                OV-Encoder <span class="text-[10px] font-normal opacity-80">(Frame)</span>
                                            </td>
                                            <td>ViT-L/14</td><td>224</td><td class="row-avg">59.9</td>
                                            <td>58.7</td><td>63.2</td><td>60.3</td><td>12.6</td><td>62.9</td><td class="best-val">54.5</td><td>85.1</td><td>81.6</td>
                                        </tr>
                                        <tr>
                                            <td class="sticky-col">
                                                OV-Encoder <span class="text-[10px] font-normal opacity-80">(Codec)</span>
                                            </td>
                                            <td>ViT-L/14</td><td>224</td><td class="best-val">61.4</td>
                                            <td class="best-val">60.1</td><td class="best-val">69.4</td><td class="best-val">60.9</td><td>12.9</td><td class="best-val">63.3</td><td>54.4</td><td class="best-val">85.4</td><td class="best-val">85.3</td>
                                        </tr>

                                    </tbody>
                                </table>
                            </div>
                            <p class="text-xs text-[#fed7aa]/70 mt-2 text-left max-w-5xl mx-auto">* Evaluation under Attentive Probe settings using single clip input, trained for 10 epochs.</p>
                            </div>

            <!-- Clear float from previous section -->
            <div style="clear: both;"></div>
                            
            <!-- Video Compression Performance Section -->
            <div class="mt-8">
                <h3 class="text-2xl font-bold text-[#fed7aa] mb-4">Patch-Efficient Video Understanding Comparison</h3>
                <p class="text-[#fed7aa]/90 mb-3 text-base">
                    Efficiency analysis comparing SigLIP2 with dense full-frame patch processing and OV-Encoder (Codec) under a fixed token budget. It is important to emphasize that OV-Encoder (Codec) does not perform temporal downsampling of the input video. All results are obtained from the same 64-frame (16384 patches) source video, where codec-native motion vectors and residuals are used to selectively extract a fixed number of spatiotemporal patches distributed across the entire temporal extent.
                </p>
                <p class="text-[#fed7aa]/90 mb-6 text-base">
                    For a fair comparison, SigLIP2 is evaluated under the same token budgets and adopts a traditional frame sampling strategy, where each group of 256 patches corresponds to a contiguous RGB frame. Under a fixed token budget, OV-Encoder (Codec) redistributes patches across time while preserving their spatial positions, enabling long-range temporal coverage. As a result, it outperforms SigLIP2 on Diving48 and Perception Test while reducing patch processing by 75.0%–96.9% compared to dense processing of 16,384 patches.                </p>
                <div class="table-wrapper" role="region" aria-label="Scrollable comparison table" style="max-width: 1100px; margin: 0 auto;">
                    <table class="results-table" style="float:left; table-layout: fixed; max-width: 100%;">
                        <colgroup>
                            <col style="width:25%">
                            <col style="width:20%">
                            <col style="width:13.75%">
                            <col style="width:13.75%">
                            <col style="width:13.75%">
                            <col style="width:13.75%">
                        </colgroup>
                        <thead>
                            <tr>
                                <th scope="col" class="text-left">Dataset</th>
                                <th scope="col" class="text-center">Model</th>
                                <th scope="col" class="text-center">512 Patches</th>
                                <th scope="col" class="text-center">1024 Patches</th>
                                <th scope="col" class="text-center">2048 Patches</th>
                                <th scope="col" class="text-center">4096 Patches</th>
                            </tr>
                        </thead>
                            <tbody>
                            <!-- Diving48 Dataset -->
                            <tr>
                                <td class="sticky-col" rowspan="2">
                                    <i class="fa-solid fa-water mr-2"></i>Diving48
                                </td>
                                <td style="word-wrap: break-word; overflow-wrap: break-word;">
                                    <div class="font-medium">SigLIP2</div>
                                    <div class="text-xs">(ViT-L/16, 256px)</div>
                                    <div class="text-xs mt-1"><i class="fa-solid fa-check-circle mr-1"></i>Traditional Frame Sampling (dense patch processing)</div>
                                </td>
                                <td class="text-center">28.1</td>
                                <td class="text-center">38.7</td>
                                <td class="text-center">53.2</td>
                                <td class="text-center">59.1</td>
                            </tr>
                            <tr>
                                <td style="word-wrap: break-word; overflow-wrap: break-word;">
                                    <div class="font-medium">OV-Encoder (Codec)</div>
                                    <div class="text-xs">(ViT-L/14, 224px)</div>
                                    <div class="text-xs mt-1"><i class="fa-solid fa-compress mr-1"></i>16384 patches -> N patches</div>
                                </td>
                                <td class="text-center best-val">
                                    <div class="font-semibold">46.5</div>
                                    <div class="text-xs mt-0.5">96.9% ↓</div>
                                </td>
                                <td class="text-center best-val">
                                    <div class="font-semibold">54.9</div>
                                    <div class="text-xs mt-0.5">93.8% ↓</div>
                                </td>
                                <td class="text-center best-val">
                                    <div class="font-semibold">58.5</div>
                                    <div class="text-xs mt-0.5">87.5% ↓</div>
                                </td>
                                <td class="text-center best-val">
                                    <div class="font-semibold">60.1</div>
                                    <div class="text-xs mt-0.5">75.0% ↓</div>
                                </td>
                            </tr>

                            <!-- Perception Test Dataset -->
                            <tr>
                                <td class="sticky-col" rowspan="2">
                                    <i class="fa-solid fa-eye mr-2"></i>Perception Test
                                </td>
                                <td style="word-wrap: break-word; overflow-wrap: break-word;">
                                    <div class="font-medium">SigLIP2</div>
                                    <div class="text-xs">(ViT-L/16, 256px)</div>
                                    <div class="text-xs mt-1"><i class="fa-solid fa-check-circle mr-1"></i>Traditional Frame Sampling (dense patch processing)</div>
                                </td>
                                <td class="text-center">48.7</td>
                                <td class="text-center">53.1</td>
                                <td class="text-center">56.3</td>
                                <td class="text-center">56.0</td>
                            </tr>
                            <tr>
                                <td style="word-wrap: break-word; overflow-wrap: break-word;">
                                    <div class="font-medium">OV-Encoder (Codec)</div>
                                    <div class="text-xs">(ViT-L/14, 224px)</div>
                                    <div class="text-xs mt-1"><i class="fa-solid fa-compress mr-1"></i>16384 patches -> N patches</div>
                                </td>
                                <td class="text-center best-val">
                                    <div class="font-semibold">50.5</div>
                                    <div class="text-xs mt-0.5">96.9% ↓</div>
                                </td>
                                <td class="text-center best-val">
                                    <div class="font-semibold">61.6</div>
                                    <div class="text-xs mt-0.5">93.8% ↓</div>
                                </td>
                                <td class="text-center best-val">
                                    <div class="font-semibold">67.2</div>
                                    <div class="text-xs mt-0.5">87.5% ↓</div>
                                </td>
                                <td class="text-center best-val">
                                    <div class="font-semibold">60.9</div>
                                    <div class="text-xs mt-0.5">75.0% ↓</div>
                                </td>
                            </tr>
                        </tbody>
                    </table>
                </div>
                <p class="text-xs text-[#fed7aa]/70 mt-2 text-left max-w-5xl mx-auto">
                  * Percentages under OV-Encoder-Codec indicate patch reduction relative to dense processing of all 16384 patches.
                </p>

                <p class="text-xs text-[#fed7aa]/70 mt-2 text-left max-w-5xl mx-auto">
                  '<span class="text-xs text-[#4ade80] font-medium">
                    <i class="fa-solid fa-compress mr-1"></i>
                    16384 patches -> N patches
                  </span>'
                  indicates Codec-Style Patch Selection, where motion-relevant patches are selectively retained instead of temporal frame sampling.
                </p>
            </div>


        </div>
    <!-- </section> -->

    <!-- BibTeX Section -->
    <section id="bibtex" class="py-16 bg-[#0369a1]">
        <div class="max-w-6xl mx-auto px-4 sm:px-6 lg:px-8">
            <h3 class="text-2xl font-bold text-[#fed7aa] mb-4">BibTeX</h3>
            <div class="table-wrapper overflow-x-auto" style="border-radius: 0.5rem; box-shadow: 0 0 0 2px rgba(254, 215, 170, 0.22); border: 1px solid rgba(254, 215, 170, 0.3); background: rgba(254, 215, 170, 0.04);">
                <pre class="text-sm text-[#fed7aa] overflow-x-auto whitespace-pre-wrap font-mono leading-relaxed" style="padding: 1.5rem; margin: 0;">@article{onevision_encoder_2026,
  title={OneVision Encoder},
  author={LMMs Lab, Glint Lab, AIM for Health Lab, MVP Lab},
  journal={arXiv preprint},
  year={2026}
}</pre>
            </div>
            <p class="text-xs text-[#fed7aa]/70 mt-4 text-center">
                If you find our work useful, please consider citing our paper.
            </p>
        </div>
    </section>

    <!-- Footer -->
    <footer class="py-8 bg-[#075985] border-t border-[#fed7aa]/20">
        <div class="max-w-6xl mx-auto px-4 sm:px-6 lg:px-8 text-center">
            <p class="text-sm text-[#fed7aa]/70">
                OneVision Encoder &middot; LLaVA-OneVision Community
            </p>
        </div>
    </footer>




    <!-- JavaScript for Image Grid -->
    <script>
        document.addEventListener('DOMContentLoaded', function() {
            const tooltip = document.getElementById('position-tooltip');
            const tooltipText = document.getElementById('tooltip-text');

            const NUM_IMAGES_SAMPLING = 4; // sampling: show all 4 image blocks
            const GRID_SIZE = 8;     // 8x8 grid per image
            
            // Constants for responsive sizing ratios
            const GAP_RATIO = 0.067;        // Gap is ~6.7% of base size (2px for 30px)
            const IMAGE_GAP_RATIO = 0.267;  // Image gap is ~26.7% of base size (8px for 30px)
            
            // Use responsive sizing based on container width
            // Patches now scale fluidly with container size instead of fixed breakpoints
            function getResponsiveSizes() {
                const container = document.getElementById('image-grid-codec');
                const containerWidth = container ? container.offsetWidth : window.innerWidth;
                
                // Calculate base size proportionally to container width
                // For mobile (2x2 grid): each block should fit within half the container
                // For desktop (4x1 grid): each block should fit within a quarter of the container
                // Target: 8x8 grid of patches + gaps should fit comfortably in available space
                
                let baseSize;
                if (containerWidth <= 768) {
                    // Mobile/tablet: 2x2 grid layout
                    // Each block gets roughly half the container width
                    // 8 patches + 7 gaps per block, so: (containerWidth / 2 - padding) / 8.5
                    baseSize = Math.max(15, Math.min(35, Math.floor((containerWidth / 2 - 40) / 8.5)));
                } else {
                    // Desktop: 4x1 horizontal layout
                    // Each block gets roughly a quarter of the container width
                    // 8 patches + 7 gaps per block, so: (containerWidth / 4 - padding) / 8.5
                    baseSize = Math.max(20, Math.min(40, Math.floor((containerWidth / 4 - 30) / 8.5)));
                }
                
                return {
                    IMAGE_SIZE: baseSize,
                    GAP: Math.max(1, Math.floor(baseSize * GAP_RATIO)),
                    IMAGE_GAP: Math.max(4, Math.floor(baseSize * IMAGE_GAP_RATIO))
                };
            }
            
            let sizes = getResponsiveSizes();
            let IMAGE_SIZE = sizes.IMAGE_SIZE;
            let GAP = sizes.GAP;
            let IMAGE_GAP = sizes.IMAGE_GAP;
            
            // Debounce function to limit resize handler execution
            function debounce(func, wait) {
                let timeout;
                return function executedFunction(...args) {
                    const later = () => {
                        clearTimeout(timeout);
                        func(...args);
                    };
                    clearTimeout(timeout);
                    timeout = setTimeout(later, wait);
                };
            }
            
            // Update sizes on window resize with debouncing (150ms delay for smoother adaptation)
            const handleResize = debounce(function() {
                const newSizes = getResponsiveSizes();
                // Check if any size property has changed
                if (newSizes.IMAGE_SIZE !== IMAGE_SIZE || 
                    newSizes.GAP !== GAP || 
                    newSizes.IMAGE_GAP !== IMAGE_GAP) {
                    
                    IMAGE_SIZE = newSizes.IMAGE_SIZE;
                    GAP = newSizes.GAP;
                    IMAGE_GAP = newSizes.IMAGE_GAP;
                    
                    // Reinitialize grids with new sizes
                    const codecContainer = document.getElementById('image-grid-codec');
                    const samplingContainer = document.getElementById('image-grid-sampling');
                    
                    if (codecContainer && codecContainer.children.length > 0) {
                        codecContainer.innerHTML = '';
                        initializeCodecGrid();
                    }
                    
                    if (samplingContainer && samplingContainer.children.length > 0) {
                        samplingContainer.innerHTML = '';
                        initializeSamplingGrid();
                    }
                }
            }, 150);
            
            window.addEventListener('resize', handleResize);

            // Complete file list for Codec Style Input: filename format is imgIdx_row_col_t_h_w
            const codecFiles = [
                '0_0_0_0_0_0','0_0_1_0_0_1','0_0_2_0_0_2','0_0_3_0_0_3','0_0_4_0_0_4','0_0_5_0_0_5','0_0_6_0_0_6','0_0_7_0_0_7',
                '0_1_0_0_1_0','0_1_1_0_1_1','0_1_2_0_1_2','0_1_3_0_1_3','0_1_4_0_1_4','0_1_5_0_1_5','0_1_6_0_1_6','0_1_7_0_1_7',
                '0_2_0_0_2_0','0_2_1_0_2_1','0_2_2_0_2_2','0_2_3_0_2_3','0_2_4_0_2_4','0_2_5_0_2_5','0_2_6_0_2_6','0_2_7_0_2_7',
                '0_3_0_0_3_0','0_3_1_0_3_1','0_3_2_0_3_2','0_3_3_0_3_3','0_3_4_0_3_4','0_3_5_0_3_5','0_3_6_0_3_6','0_3_7_0_3_7',
                '0_4_0_0_4_0','0_4_1_0_4_1','0_4_2_0_4_2','0_4_3_0_4_3','0_4_4_0_4_4','0_4_5_0_4_5','0_4_6_0_4_6','0_4_7_0_4_7',
                '0_5_0_0_5_0','0_5_1_0_5_1','0_5_2_0_5_2','0_5_3_0_5_3','0_5_4_0_5_4','0_5_5_0_5_5','0_5_6_0_5_6','0_5_7_0_5_7',
                '0_6_0_0_6_0','0_6_1_0_6_1','0_6_2_0_6_2','0_6_3_0_6_3','0_6_4_0_6_4','0_6_5_0_6_5','0_6_6_0_6_6','0_6_7_0_6_7',
                '0_7_0_0_7_0','0_7_1_0_7_1','0_7_2_0_7_2','0_7_3_0_7_3','0_7_4_0_7_4','0_7_5_0_7_5','0_7_6_0_7_6','0_7_7_0_7_7',
                '1_0_0_1_3_4','1_0_1_1_4_3','1_0_2_1_4_4','1_0_3_1_4_5','1_0_4_1_5_3','1_0_5_1_5_4','1_0_6_2_4_3','1_0_7_2_4_4',
                '1_1_0_2_4_5','1_1_1_5_4_3','1_1_2_5_5_3','1_1_3_5_5_4','1_1_4_6_4_3','1_1_5_6_5_2','1_1_6_6_5_3','1_1_7_6_5_4',
                '1_2_0_7_2_2','1_2_1_7_2_3','1_2_2_7_3_3','1_2_3_7_4_3','1_2_4_7_5_2','1_2_5_7_5_3','1_2_6_8_4_4','1_2_7_8_4_5',
                '1_3_0_8_4_6','1_3_1_8_5_4','1_3_2_8_5_5','1_3_3_8_5_6','1_3_4_9_4_4','1_3_5_9_4_6','1_3_6_9_5_4','1_3_7_9_5_5',
                '1_4_0_9_5_6','1_4_1_11_3_5','1_4_2_11_4_4','1_4_3_11_4_5','1_4_4_11_5_4','1_4_5_11_5_5','1_4_6_12_5_2','1_4_7_13_4_2',
                '1_5_0_13_5_2','1_5_1_17_5_2','1_5_2_17_5_3','1_5_3_17_5_4','1_5_4_17_5_5','1_5_5_19_3_1','1_5_6_19_3_2','1_5_7_19_3_3',
                '1_6_0_19_4_1','1_6_1_19_4_2','1_6_2_19_4_3','1_6_3_19_5_1','1_6_4_19_5_3','1_6_5_20_2_0','1_6_6_20_2_5','1_6_7_20_3_4',
                '1_7_0_20_3_5','1_7_1_21_3_1','1_7_2_21_3_2','1_7_3_21_4_1','1_7_4_21_4_2','1_7_5_21_4_3','1_7_6_21_4_4','1_7_7_21_5_1',
                '2_0_0_21_5_2','2_0_1_21_5_3','2_0_2_21_5_4','2_0_3_22_3_1','2_0_4_22_3_2','2_0_5_22_3_3','2_0_6_22_4_1','2_0_7_22_4_2',
                '2_1_0_22_4_3','2_1_1_22_5_2','2_1_2_23_2_4','2_1_3_23_3_4','2_1_4_27_2_1','2_1_5_27_3_2','2_1_6_27_4_1','2_1_7_27_4_2',
                '2_2_0_27_5_1','2_2_1_27_5_2','2_2_2_27_5_3','2_2_3_29_4_2','2_2_4_29_4_3','2_2_5_29_5_2','2_2_6_29_5_3','2_2_7_29_5_4',
                '2_3_0_31_4_1','2_3_1_31_4_4','2_3_2_31_5_2','2_3_3_31_5_3','2_3_4_32_4_4','2_3_5_32_4_5','2_3_6_34_3_3','2_3_7_34_3_4',
                '2_4_0_34_3_5','2_4_1_34_4_3','2_4_2_34_4_4','2_4_3_34_4_5','2_4_4_34_5_3','2_4_5_34_5_4','2_4_6_34_5_5','2_4_7_35_3_3',
                '2_5_0_35_3_4','2_5_1_35_3_5','2_5_2_35_4_3','2_5_3_35_4_4','2_5_4_35_4_5','2_5_5_35_5_4','2_5_6_35_5_5','2_5_7_36_2_6',
                '2_6_0_37_2_6','2_6_1_38_2_4','2_6_2_38_2_5','2_6_3_38_2_6','2_6_4_38_2_7','2_6_5_38_3_4','2_6_6_38_3_5','2_6_7_38_3_6',
                '2_7_0_38_4_4','2_7_1_38_4_5','2_7_2_38_4_6','2_7_3_38_5_6','2_7_4_39_2_7','2_7_5_41_2_1','2_7_6_41_3_5','2_7_7_42_2_5',
                '3_0_0_42_3_5','3_0_1_45_2_4','3_0_2_46_4_2','3_0_3_47_3_1','3_0_4_47_3_2','3_0_5_47_3_3','3_0_6_47_4_1','3_0_7_47_4_2',
                '3_1_0_47_4_3','3_1_1_47_5_2','3_1_2_48_5_2','3_1_3_50_3_2','3_1_4_50_3_3','3_1_5_50_3_4','3_1_6_50_3_5','3_1_7_50_4_2',
                '3_2_0_50_4_3','3_2_1_50_4_4','3_2_2_50_4_5','3_2_3_50_5_1','3_2_4_50_5_2','3_2_5_50_5_3','3_2_6_50_5_4','3_2_7_50_5_5',
                '3_3_0_53_2_4','3_3_1_53_3_3','3_3_2_53_3_4','3_3_3_53_4_2','3_3_4_53_4_3','3_3_5_53_4_4','3_3_6_53_5_2','3_3_7_53_5_3',
                '3_4_0_54_2_3','3_4_1_54_3_3','3_4_2_56_3_2','3_4_3_58_4_3','3_4_4_58_4_4','3_4_5_58_4_5','3_4_6_58_5_3','3_4_7_58_5_4',
                '3_5_0_58_5_5','3_5_1_59_4_3','3_5_2_59_4_4','3_5_3_59_4_5','3_5_4_59_5_4','3_5_5_59_5_5','3_5_6_61_2_2','3_5_7_61_3_2',
                '3_6_0_62_2_2','3_6_1_62_2_3','3_6_2_62_2_4','3_6_3_62_2_5','3_6_4_62_3_2','3_6_5_62_3_3','3_6_6_62_3_4','3_6_7_62_3_5',
                '3_7_0_62_4_2','3_7_1_62_4_3','3_7_2_62_4_4','3_7_3_62_4_5','3_7_4_63_3_4','3_7_5_63_3_6','3_7_6_63_3_7','3_7_7_63_4_4'
            ];

            // Build file map for codec: "imgIdx_row_col" -> {filename, t, h, w, row, col}
            const codecFileMap = {};
            codecFiles.forEach(f => {
                const parts = f.split('_');
                const key = `${parts[0]}_${parts[1]}_${parts[2]}`;
                codecFileMap[key] = {
                    filename: f + '.jpg',
                    t: parseInt(parts[3]),
                    h: parseInt(parts[4]),
                    w: parseInt(parts[5]),
                    displayRow: parseInt(parts[1]),
                    displayCol: parseInt(parts[2])
                };
            });

            // Animation state
            let isHovering = false;
            const ANIMATION_DELAY = 2000; // 2 seconds interval
            const ANIMATION_DURATION = 300;
            const NUM_ANIM_BLOCKS = 3; // 3 animated blocks + 1 static reference

            // Create 4-block layout: static reference (t=1) + 3 animated blocks
            function createTemporalAnimationGrid(gridContainer, allPatches, imageBasePath) {
                const cellSize = IMAGE_SIZE + GAP;
                const blockWidth = GRID_SIZE * cellSize - GAP;
                const blockGap = 20;
                const totalBlocks = 1 + NUM_ANIM_BLOCKS;
                const totalHeight = GRID_SIZE * cellSize - GAP;
                
                // Detect layout mode based on container width
                const containerWidth = gridContainer.offsetWidth || window.innerWidth;
                const isMobileLayout = containerWidth <= 768;
                
                // Calculate appropriate grid dimensions
                let totalWidth;
                if (isMobileLayout) {
                    // Mobile: 2x2 grid, so width should accommodate 2 blocks side by side
                    totalWidth = 2 * blockWidth + blockGap;
                } else {
                    // Desktop: 4x1 horizontal layout
                    totalWidth = totalBlocks * blockWidth + (totalBlocks - 1) * blockGap;
                }

                // Layout note:
                // - Mobile uses CSS grid rules (direct children of #image-grid-codec).
                // - Desktop/tablet uses an inner strip with fixed width so we can scroll
                //   instead of forcing the container itself to a fixed width.
                gridContainer.style.position = 'relative';
                gridContainer.style.width = '100%';
                gridContainer.style.maxWidth = '100%';
                gridContainer.style.overflowX = isMobileLayout ? 'hidden' : 'auto';
                gridContainer.style.overflowY = 'hidden';
                gridContainer.style.marginBottom = '2rem';

                let layoutRoot = gridContainer;
                if (!isMobileLayout) {
                    const strip = document.createElement('div');
                    strip.className = 'codec-strip';
                    strip.style.position = 'relative';
                    strip.style.width = totalWidth + 'px';
                    strip.style.height = (totalHeight + 60) + 'px';
                    strip.style.margin = '0 auto';
                    gridContainer.appendChild(strip);
                    layoutRoot = strip;
                }

                // group patches by t value: { t: [{h, w, filename}, ...] }
                const patchesByT = {};
                allPatches.forEach(p => {
                    if (!patchesByT[p.t]) patchesByT[p.t] = [];
                    patchesByT[p.t].push(p);
                });

                // Create wrapper for reference block (Block 0)
                const refBlockWrapper = document.createElement('div');
                refBlockWrapper.className = 'codec-block-wrapper';
                
                if (!isMobileLayout) {
                    // Desktop: use absolute positioning
                    refBlockWrapper.style.position = 'absolute';
                    refBlockWrapper.style.left = '0px';
                }
                
                refBlockWrapper.style.width = blockWidth + 'px';
                refBlockWrapper.style.height = (totalHeight + 40) + 'px';
                refBlockWrapper.style.display = 'flex';
                refBlockWrapper.style.flexDirection = 'column';
                refBlockWrapper.style.alignItems = 'center';
                refBlockWrapper.style.overflow = 'visible';
                
                // Create inner grid container for patches
                const refGridDiv = document.createElement('div');
                refGridDiv.style.position = 'relative';
                refGridDiv.style.width = blockWidth + 'px';
                refGridDiv.style.height = totalHeight + 'px';

                // Block 0: Static reference frame (t=0, displayed as t=1)
                const refPatches = patchesByT[0] || [];
                for (let h = 0; h < GRID_SIZE; h++) {
                    for (let w = 0; w < GRID_SIZE; w++) {
                        const imgContainer = document.createElement('div');
                        imgContainer.style.position = 'absolute';
                        imgContainer.style.width = IMAGE_SIZE + 'px';
                        imgContainer.style.height = IMAGE_SIZE + 'px';
                        imgContainer.style.left = (w * cellSize) + 'px';
                        imgContainer.style.top = (h * cellSize) + 'px';
                        imgContainer.style.overflow = 'hidden';
                        imgContainer.style.border = '1px solid rgba(254, 215, 170, 0.22)';
                        imgContainer.style.borderRadius = '2px';
                        imgContainer.style.cursor = 'pointer';

                        const patch = refPatches.find(p => p.h === h && p.w === w);
                        if (patch) {
                            const img = document.createElement('img');
                            img.src = imageBasePath + patch.filename;
                            img.style.width = '100%';
                            img.style.height = '100%';
                            img.style.objectFit = 'cover';
                            imgContainer.appendChild(img);
                            imgContainer.dataset.t = patch.t;
                            imgContainer.dataset.h = patch.h;
                            imgContainer.dataset.w = patch.w;

                            imgContainer.addEventListener('mouseenter', function(e) {
                                this.style.transform = 'scale(1.5)';
                                this.style.boxShadow = '0 4px 6px -1px rgba(0, 0, 0, 0.3)';
                                this.style.zIndex = '100';
                                tooltipText.textContent = `t=${parseInt(this.dataset.t) + 1}, h=${this.dataset.h}, w=${this.dataset.w}`;
                                tooltip.style.left = (e.clientX + 15) + 'px';
                                tooltip.style.top = (e.clientY + 15) + 'px';
                                tooltip.style.opacity = '1';
                            });
                            imgContainer.addEventListener('mousemove', function(e) {
                                tooltip.style.left = (e.clientX + 15) + 'px';
                                tooltip.style.top = (e.clientY + 15) + 'px';
                            });
                            imgContainer.addEventListener('mouseleave', function() {
                                this.style.transform = 'scale(1)';
                                this.style.boxShadow = 'none';
                                this.style.zIndex = '';
                                tooltip.style.opacity = '0';
                            });
                        } else {
                            imgContainer.style.backgroundColor = 'rgba(254, 215, 170, 0.08)';
                        }

                        refGridDiv.appendChild(imgContainer);
                    }
                }
                
                refBlockWrapper.appendChild(refGridDiv);

                // Label for reference block
                const refLabel = document.createElement('div');
                refLabel.style.marginTop = '10px';
                refLabel.style.fontSize = '14px';
                refLabel.style.fontWeight = '600';
                refLabel.style.color = '#fed7aa';
                refLabel.textContent = 't = 1';
                refBlockWrapper.appendChild(refLabel);
                layoutRoot.appendChild(refBlockWrapper);

                // Animated blocks (3 blocks showing t=2,3,4, etc.)
                const animBlocks = [];
                const animLabels = [];

                for (let blockIdx = 0; blockIdx < NUM_ANIM_BLOCKS; blockIdx++) {
                    const blockX = (1 + blockIdx) * (blockWidth + blockGap);
                    
                    // Create wrapper for this animated block
                    const blockWrapper = document.createElement('div');
                    blockWrapper.className = 'codec-block-wrapper';
                    
                    if (!isMobileLayout) {
                        // Desktop: use absolute positioning
                        blockWrapper.style.position = 'absolute';
                        blockWrapper.style.left = blockX + 'px';
                    }
                    
                    blockWrapper.style.width = blockWidth + 'px';
                    blockWrapper.style.height = (totalHeight + 40) + 'px';
                    blockWrapper.style.display = 'flex';
                    blockWrapper.style.flexDirection = 'column';
                    blockWrapper.style.alignItems = 'center';
                    blockWrapper.style.overflow = 'visible';
                    
                    // Create inner grid container for patches
                    const animGridDiv = document.createElement('div');
                    animGridDiv.style.position = 'relative';
                    animGridDiv.style.width = blockWidth + 'px';
                    animGridDiv.style.height = totalHeight + 'px';
                    
                    const gridCells = {};

                    for (let h = 0; h < GRID_SIZE; h++) {
                        for (let w = 0; w < GRID_SIZE; w++) {
                            const imgContainer = document.createElement('div');
                            imgContainer.style.position = 'absolute';
                            imgContainer.style.width = IMAGE_SIZE + 'px';
                            imgContainer.style.height = IMAGE_SIZE + 'px';
                            imgContainer.style.left = (w * cellSize) + 'px';
                            imgContainer.style.top = (h * cellSize) + 'px';
                            imgContainer.style.overflow = 'hidden';
                            imgContainer.style.border = '1px solid rgba(254, 215, 170, 0.22)';
                            imgContainer.style.borderRadius = '2px';
                            imgContainer.style.backgroundColor = 'rgba(254, 215, 170, 0.08)';
                            imgContainer.style.transition = `opacity ${ANIMATION_DURATION}ms ease-in-out`;
                            imgContainer.style.cursor = 'pointer';

                            const img = document.createElement('img');
                            img.style.width = '100%';
                            img.style.height = '100%';
                            img.style.objectFit = 'cover';

                            imgContainer.appendChild(img);
                            animGridDiv.appendChild(imgContainer);
                            gridCells[`${h}_${w}`] = { container: imgContainer, img: img };

                            imgContainer.addEventListener('mouseenter', function(e) {
                                if (this.dataset.t !== undefined) {
                                    this.style.transform = 'scale(1.5)';
                                    this.style.boxShadow = '0 4px 6px -1px rgba(0, 0, 0, 0.3)';
                                    this.style.zIndex = '100';
                                    tooltipText.textContent = `t=${parseInt(this.dataset.t) + 1}, h=${this.dataset.h}, w=${this.dataset.w}`;
                                    tooltip.style.left = (e.clientX + 15) + 'px';
                                    tooltip.style.top = (e.clientY + 15) + 'px';
                                    tooltip.style.opacity = '1';
                                }
                            });
                            imgContainer.addEventListener('mousemove', function(e) {
                                tooltip.style.left = (e.clientX + 15) + 'px';
                                tooltip.style.top = (e.clientY + 15) + 'px';
                            });
                            imgContainer.addEventListener('mouseleave', function() {
                                this.style.transform = 'scale(1)';
                                this.style.boxShadow = 'none';
                                this.style.zIndex = '';
                                tooltip.style.opacity = '0';
                            });
                        }
                    }
                    
                    blockWrapper.appendChild(animGridDiv);

                    // Label for this block
                    const blockLabel = document.createElement('div');
                    blockLabel.style.marginTop = '10px';
                    blockLabel.style.fontSize = '14px';
                    blockLabel.style.fontWeight = '600';
                    blockLabel.style.color = '#fed7aa';
                    blockLabel.textContent = `t = ...`;
                    blockWrapper.appendChild(blockLabel);
                    animLabels.push(blockLabel);
                    layoutRoot.appendChild(blockWrapper);
                    animBlocks.push(gridCells);
                }

                let baseT = 1; // start from t=1 (displayed as t=2)

                function updateAnimBlocks() {
                    for (let blockIdx = 0; blockIdx < NUM_ANIM_BLOCKS; blockIdx++) {
                        const t = ((baseT + blockIdx - 1) % 63) + 1; // cycle t=1 to t=63 (display as t=2 to t=64)
                        const gridCells = animBlocks[blockIdx];

                        animLabels[blockIdx].textContent = 't = ' + (t + 1);

                        for (let h = 0; h < GRID_SIZE; h++) {
                            for (let w = 0; w < GRID_SIZE; w++) {
                                const cell = gridCells[`${h}_${w}`];
                                cell.container.style.opacity = '0.55';
                                cell.img.style.display = 'none';
                                delete cell.container.dataset.t;
                                delete cell.container.dataset.h;
                                delete cell.container.dataset.w;
                            }
                        }

                        const patches = patchesByT[t] || [];
                        patches.forEach(p => {
                            const cell = gridCells[`${p.h}_${p.w}`];
                            if (cell) {
                                cell.img.src = imageBasePath + p.filename;
                                cell.img.style.display = 'block';
                                cell.container.style.opacity = '1';
                                cell.container.dataset.t = p.t;
                                cell.container.dataset.h = p.h;
                                cell.container.dataset.w = p.w;
                            }
                        });
                    }
                }

                function animateFrame() {
                    if (isHovering) return;
                    updateAnimBlocks();
                    baseT = ((baseT + NUM_ANIM_BLOCKS - 1) % 63) + 1;
                }

                gridContainer.addEventListener('mouseenter', function() {
                    isHovering = true;
                });
                gridContainer.addEventListener('mouseleave', function() {
                    isHovering = false;
                });

                updateAnimBlocks();
                setInterval(animateFrame, ANIMATION_DELAY);
            }

            // Standard grid for sampling
            function createImageGrid(gridContainer, fileMap, imageBasePath) {
                const cellSize = IMAGE_SIZE + GAP;
                const blockWidth = GRID_SIZE * cellSize - GAP;
                const blockHeight = GRID_SIZE * cellSize - GAP;
                
                // Detect layout mode based on container width
                const containerWidth = gridContainer.offsetWidth || window.innerWidth;
                const isMobileLayout = containerWidth <= 768;
                
                const gap = 20;
                const totalWidth = NUM_IMAGES_SAMPLING * blockWidth + (NUM_IMAGES_SAMPLING - 1) * gap;
                const totalHeight = blockHeight + 30; // blockHeight + label space
                
                // Layout note:
                // - Mobile uses CSS grid rules (direct children of #image-grid-sampling).
                // - Desktop/tablet uses an inner strip with fixed width so we can scroll.
                gridContainer.style.position = 'relative';
                gridContainer.style.width = '100%';
                gridContainer.style.maxWidth = '100%';
                gridContainer.style.overflowX = isMobileLayout ? 'hidden' : 'auto';
                gridContainer.style.overflowY = 'hidden';
                gridContainer.style.marginBottom = '2rem';

                let layoutRoot = gridContainer;
                if (!isMobileLayout) {
                    const strip = document.createElement('div');
                    strip.className = 'sampling-strip';
                    strip.style.position = 'relative';
                    strip.style.width = totalWidth + 'px';
                    strip.style.height = totalHeight + 'px';
                    strip.style.margin = '0 auto';
                    gridContainer.appendChild(strip);
                    layoutRoot = strip;
                }

                // Create 4 frames - mobile: 2x2 grid, desktop: horizontal 4-frame layout
                for (let imgIdx = 0; imgIdx < NUM_IMAGES_SAMPLING; imgIdx++) {
                    // Create wrapper for this frame
                    const frameWrapper = document.createElement('div');
                    frameWrapper.className = 'sampling-frame-wrapper';
                    
                    if (!isMobileLayout) {
                        // Desktop: use absolute positioning for horizontal 4-frame layout
                        frameWrapper.style.position = 'absolute';
                        frameWrapper.style.left = imgIdx * (blockWidth + gap) + 'px';
                        frameWrapper.style.top = '0px';
                    }
                    
                    frameWrapper.style.width = blockWidth + 'px';
                    frameWrapper.style.height = (blockHeight + 30) + 'px';
                    
                    // Create 8x8 grid for this frame
                    const gridDiv = document.createElement('div');
                    gridDiv.style.position = 'relative';
                    gridDiv.style.width = blockWidth + 'px';
                    gridDiv.style.height = blockHeight + 'px';
                    
                    for (let row = 0; row < GRID_SIZE; row++) {
                        for (let col = 0; col < GRID_SIZE; col++) {
                            const key = `${imgIdx}_${row}_${col}`;
                            const fileInfo = fileMap[key];

                            const imgContainer = document.createElement('div');
                            imgContainer.style.position = 'absolute';
                            imgContainer.style.width = IMAGE_SIZE + 'px';
                            imgContainer.style.height = IMAGE_SIZE + 'px';
                            imgContainer.style.left = (col * cellSize) + 'px';
                            imgContainer.style.top = (row * cellSize) + 'px';
                            imgContainer.style.cursor = 'pointer';
                            imgContainer.style.transition = 'all 0.15s';
                            imgContainer.style.overflow = 'hidden';
                            imgContainer.style.border = '1px solid rgba(254, 215, 170, 0.3)';
                            imgContainer.style.borderRadius = '2px';

                            const img = document.createElement('img');
                            img.style.width = '100%';
                            img.style.height = '100%';
                            img.style.objectFit = 'cover';
                            img.alt = `Patch ${key}`;

                            if (fileInfo) {
                                img.src = imageBasePath + fileInfo.filename;
                                imgContainer.dataset.t = fileInfo.t;
                                imgContainer.dataset.h = fileInfo.h;
                                imgContainer.dataset.w = fileInfo.w;
                            } else {
                                imgContainer.style.backgroundColor = 'rgba(254, 215, 170, 0.08)';
                            }

                            img.onerror = function() {
                                this.style.display = 'none';
                                imgContainer.style.backgroundColor = 'rgba(254, 215, 170, 0.08)';
                            };

                            imgContainer.appendChild(img);

                            imgContainer.addEventListener('mouseenter', function(e) {
                                this.style.transform = 'scale(1.5)';
                                this.style.boxShadow = '0 4px 6px -1px rgba(0, 0, 0, 0.3)';
                                this.style.zIndex = '100';
                                const t = this.dataset.t || '?';
                                const h = this.dataset.h || '?';
                                const w = this.dataset.w || '?';
                                tooltipText.textContent = `Frame ${parseInt(t) + 1}, h=${h}, w=${w}`;
                                tooltip.style.left = (e.clientX + 15) + 'px';
                                tooltip.style.top = (e.clientY + 15) + 'px';
                                tooltip.style.opacity = '1';
                            });

                            imgContainer.addEventListener('mousemove', function(e) {
                                tooltip.style.left = (e.clientX + 15) + 'px';
                                tooltip.style.top = (e.clientY + 15) + 'px';
                            });

                            imgContainer.addEventListener('mouseleave', function() {
                                this.style.transform = 'scale(1)';
                                this.style.boxShadow = 'none';
                                this.style.zIndex = '';
                                tooltip.style.opacity = '0';
                            });

                            gridDiv.appendChild(imgContainer);
                        }
                    }
                    
                    frameWrapper.appendChild(gridDiv);
                    
                    // Add frame label
                    const frameLabel = document.createElement('div');
                    frameLabel.style.textAlign = 'center';
                    frameLabel.style.fontSize = '14px';
                    frameLabel.style.fontWeight = '600';
                    frameLabel.style.color = '#fed7aa';
                    frameLabel.style.marginTop = '8px';
                    const frameMapping = {0: 8, 1: 16, 2: 32, 3: 64};
                    frameLabel.textContent = `Frame ${imgIdx + 1} (${frameMapping[imgIdx]} frames sampled)`;
                    frameWrapper.appendChild(frameLabel);
                    
                    layoutRoot.appendChild(frameWrapper);
                }
            }

            // Build file map for sampling
            // New naming: {imgIdx}_{row}_{col}_{frames}_{row}_{col}.jpg
            // imgIdx 0 -> 8 frames, 1 -> 16 frames, 2 -> 32 frames, 3 -> 64 frames
            const frameMapping = {0: 8, 1: 16, 2: 32, 3: 64};
            const samplingFileMap = {};
            for (let imgIdx = 0; imgIdx < NUM_IMAGES_SAMPLING; imgIdx++) {
                const frames = frameMapping[imgIdx];
                for (let row = 0; row < GRID_SIZE; row++) {
                    for (let col = 0; col < GRID_SIZE; col++) {
                        const key = `${imgIdx}_${row}_${col}`;
                        samplingFileMap[key] = {
                            filename: `${imgIdx}_${row}_${col}_${frames}_${row}_${col}.jpg`,
                            t: imgIdx,
                            h: row,
                            w: col
                        };
                    }
                }
            }

            // Convert codec file map to flat array with {t, h, w, filename}
            const allCodecPatches = Object.values(codecFileMap).map(f => ({
                t: f.t,
                h: f.h,
                w: f.w,
                filename: f.filename
            }));

            // Initialization functions
            function initializeCodecGrid() {
                const codecGridContainer = document.getElementById('image-grid-codec');
                if (codecGridContainer) {
                    createTemporalAnimationGrid(codecGridContainer, allCodecPatches, 'images/patches_codec/');
                }
            }
            
            function initializeSamplingGrid() {
                const samplingGridContainer = document.getElementById('image-grid-sampling');
                if (samplingGridContainer) {
                    createImageGrid(samplingGridContainer, samplingFileMap, 'images/patches/');
                }
            }

            // Create grids on initial load
            initializeCodecGrid();
            initializeSamplingGrid();
        });
    </script>


    <!-- JavaScript for Pipeline Case Switching -->
    <script>
        // Mobile Menu Toggle
        document.addEventListener('DOMContentLoaded', function() {
            const mobileMenuBtn = document.getElementById('mobileMenuBtn');
            const mobileMenu = document.getElementById('mobileMenu');
            const mobileNavLinks = mobileMenu.querySelectorAll('a');

            if (mobileMenuBtn) {
                mobileMenuBtn.addEventListener('click', function() {
                    mobileMenu.classList.toggle('active');
                    const icon = this.querySelector('i');
                    if (mobileMenu.classList.contains('active')) {
                        icon.classList.remove('fa-bars');
                        icon.classList.add('fa-times');
                    } else {
                        icon.classList.remove('fa-times');
                        icon.classList.add('fa-bars');
                    }
                });

                // Close mobile menu when clicking on a link
                mobileNavLinks.forEach(link => {
                    link.addEventListener('click', function() {
                        mobileMenu.classList.remove('active');
                        const icon = mobileMenuBtn.querySelector('i');
                        icon.classList.remove('fa-times');
                        icon.classList.add('fa-bars');
                    });
                });

                // Close mobile menu when clicking outside
                document.addEventListener('click', function(event) {
                    if (!mobileMenuBtn.contains(event.target) && !mobileMenu.contains(event.target)) {
                        mobileMenu.classList.remove('active');
                        const icon = mobileMenuBtn.querySelector('i');
                        icon.classList.remove('fa-times');
                        icon.classList.add('fa-bars');
                    }
                });
            }
        });

        // Pipeline cases data - 7 different pipeline visualizations
        const pipelineCases = [
            {
                image: 'images/case1.webm',
                title: 'Case 1: Standard Pipeline'
            },
            {
                image: 'images/case2.webm',
                title: 'Case 2: Saliency Focus'
            },
            {
                image: 'images/case3.webm',
                title: 'Case 3: Compression Analysis'
            },
            {
                image: 'images/case4.webm',
                title: 'Case 4: Zigzag Ordering'
            },
            {
                image: 'images/case5.webm',
                title: 'Case 5: Comparative Analysis'
            },
            {
                image: 'images/case6.webm',
                title: 'Case 6: Comparative Analysis'
            },
            {
                image: 'images/case7.webm',
                title: 'Case 7: Comparative Analysis'
            }
        ];

        let currentPipelineCase = 0;
        let isTransitioning = false;
        let autoPlayInterval = null;
        let isAutoPlaying = true;
        const AUTO_PLAY_DELAY = 5000; // 5 seconds between auto-switches

        function displayPipelineCase(caseIndex) {
            if (isTransitioning) return;
            isTransitioning = true;

            const imageElement = document.getElementById('pipelineGifImage');
            const descElement = document.getElementById('pipelineDescription');
            const caseData = pipelineCases[caseIndex];

            // Fade out
            imageElement.style.opacity = '0';

            setTimeout(() => {
                // Update content
                imageElement.src = caseData.image;
                if (caseData.description) {
                    descElement.textContent = caseData.description;
                }

                // Update dots
                updatePipelineDots(caseIndex);

                // Fade in
                setTimeout(() => {
                    imageElement.style.opacity = '1';
                    isTransitioning = false;
                }, 100);
            }, 300);
        }

        function nextPipelineCase() {
            currentPipelineCase = (currentPipelineCase + 1) % pipelineCases.length;
            displayPipelineCase(currentPipelineCase);
        }

        function prevPipelineCase() {
            currentPipelineCase = (currentPipelineCase - 1 + pipelineCases.length) % pipelineCases.length;
            displayPipelineCase(currentPipelineCase);
        }

        function startAutoPlay() {
            if (autoPlayInterval) return;
            isAutoPlaying = true;
            autoPlayInterval = setInterval(nextPipelineCase, AUTO_PLAY_DELAY);
        }

        function stopAutoPlay() {
            if (autoPlayInterval) {
                clearInterval(autoPlayInterval);
                autoPlayInterval = null;
            }
            isAutoPlaying = false;
        }

        function restartAutoPlay() {
            stopAutoPlay();
            startAutoPlay();
        }

        function updatePipelineDots(activeIndex) {
            const dotsContainer = document.getElementById('pipelineDots');
            dotsContainer.innerHTML = '';

            pipelineCases.forEach((caseData, index) => {
                const dot = document.createElement('button');
                const isActive = index === activeIndex;

                dot.type = 'button';
                if (isActive) {
                    dot.setAttribute('aria-current', 'true');
                }

                dot.setAttribute('aria-label', caseData.title);
                dot.setAttribute('title', caseData.title);

                // Click to switch case
                dot.addEventListener('click', function() {
                    if (currentPipelineCase !== index) {
                        currentPipelineCase = index;
                        displayPipelineCase(currentPipelineCase);
                        restartAutoPlay(); // Restart auto-play timer after manual interaction
                    }
                });

                // Hover to switch case and apply visual effects
                dot.addEventListener('mouseenter', function() {
                    if (currentPipelineCase !== index) {
                        currentPipelineCase = index;
                        displayPipelineCase(currentPipelineCase);
                        restartAutoPlay(); // Restart auto-play timer after manual interaction
                    }
                });

                dotsContainer.appendChild(dot);
            });
        }

        // Initialize on page load
        document.addEventListener('DOMContentLoaded', function() {
            updatePipelineDots(0);

            // Arrow button handlers
            const prevBtn = document.getElementById('pipelinePrevBtn');
            const nextBtn = document.getElementById('pipelineNextBtn');
            const container = document.getElementById('pipelineGifContainer');

            // Previous button
            prevBtn.addEventListener('click', function(e) {
                e.stopPropagation();
                prevPipelineCase();
                restartAutoPlay();
            });

            // Next button
            nextBtn.addEventListener('click', function(e) {
                e.stopPropagation();
                nextPipelineCase();
                restartAutoPlay();
            });

            // Arrow hover is handled by CSS for consistent theming.

            // Pause auto-play on hover, resume on leave
            container.addEventListener('mouseenter', function() {
                if (isAutoPlaying) {
                    stopAutoPlay();
                }
            });

            container.addEventListener('mouseleave', function() {
                if (!isAutoPlaying) {
                    startAutoPlay();
                }
            });

            // Start auto-play
            startAutoPlay();
        });
    </script>

</body>
</html>
